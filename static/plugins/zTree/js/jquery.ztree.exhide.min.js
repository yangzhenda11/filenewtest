!function(e){e.extend(!0,e.fn.zTree._z,{view:{clearOldFirstNode:function(e,i){for(var d=i.getNextNode();d;){if(d.isFirstNode){d.isFirstNode=!1,t.setNodeLineIcos(e,d);break}if(d.isLastNode)break;d=d.getNextNode()}},clearOldLastNode:function(e,i,d){for(i=i.getPreNode();i;){if(i.isLastNode){i.isLastNode=!1,d&&t.setNodeLineIcos(e,i);break}if(i.isFirstNode)break;i=i.getPreNode()}},makeDOMNodeMainBefore:function(e,i,t){i=o.isHidden(i,t),e.push("<li ",i?"style='display:none;' ":"","id='",t.tId,"' class='",d.className.LEVEL,t.level,"' tabindex='0' hidefocus='true' treenode>")},showNode:function(e,i){o.isHidden(e,i,!1),o.initShowForExCheck(e,i),n(i,e).show()},showNodes:function(e,i,d){if(i&&0!=i.length){var n,s,r={};for(n=0,s=i.length;s>n;n++){var a=i[n];if(!r[a.parentTId]){var N=a.getParentNode();r[a.parentTId]=null===N?o.getRoot(e):a.getParentNode()}t.showNode(e,a,d)}for(var c in r)i=o.nodeChildren(e,r[c]),t.setFirstNodeForShow(e,i),t.setLastNodeForShow(e,i)}},hideNode:function(e,i){o.isHidden(e,i,!0),i.isFirstNode=!1,i.isLastNode=!1,o.initHideForExCheck(e,i),t.cancelPreSelectedNode(e,i),n(i,e).hide()},hideNodes:function(e,i,d){if(i&&0!=i.length){var n,s,r={};for(n=0,s=i.length;s>n;n++){var a=i[n];if((a.isFirstNode||a.isLastNode)&&!r[a.parentTId]){var N=a.getParentNode();r[a.parentTId]=null===N?o.getRoot(e):a.getParentNode()}t.hideNode(e,a,d)}for(var c in r)i=o.nodeChildren(e,r[c]),t.setFirstNodeForHide(e,i),t.setLastNodeForHide(e,i)}},setFirstNode:function(e,i){var d=o.nodeChildren(e,i),n=o.isHidden(e,d[0],!1);d.length>0&&!n?d[0].isFirstNode=!0:d.length>0&&t.setFirstNodeForHide(e,d)},setLastNode:function(e,i){var d=o.nodeChildren(e,i),n=o.isHidden(e,d[0]);d.length>0&&!n?d[d.length-1].isLastNode=!0:d.length>0&&t.setLastNodeForHide(e,d)},setFirstNodeForHide:function(e,i){var d,n,s;for(n=0,s=i.length;s>n&&(d=i[n],!d.isFirstNode);n++){if(!o.isHidden(e,d)&&!d.isFirstNode){d.isFirstNode=!0,t.setNodeLineIcos(e,d);break}d=null}return d},setFirstNodeForShow:function(e,i){var d,n,s,r,a;for(n=0,s=i.length;s>n;n++){d=i[n];var N=o.isHidden(e,d);if(!r&&!N&&d.isFirstNode){r=d;break}if(r||N||d.isFirstNode){if(r&&d.isFirstNode){d.isFirstNode=!1,a=d,t.setNodeLineIcos(e,d);break}}else d.isFirstNode=!0,r=d,t.setNodeLineIcos(e,d)}return{"new":r,old:a}},setLastNodeForHide:function(e,i){var d,n;for(n=i.length-1;n>=0&&(d=i[n],!d.isLastNode);n--){if(!o.isHidden(e,d)&&!d.isLastNode){d.isLastNode=!0,t.setNodeLineIcos(e,d);break}d=null}return d},setLastNodeForShow:function(e,i){var d,n,s,r;for(n=i.length-1;n>=0;n--){d=i[n];var a=o.isHidden(e,d);if(!s&&!a&&d.isLastNode){s=d;break}if(s||a||d.isLastNode){if(s&&d.isLastNode){d.isLastNode=!1,r=d,t.setNodeLineIcos(e,d);break}}else d.isLastNode=!0,s=d,t.setNodeLineIcos(e,d)}return{"new":s,old:r}}},data:{initHideForExCheck:function(e,i){o.isHidden(e,i)&&e.check&&e.check.enable&&("undefined"==typeof i._nocheck&&(i._nocheck=!!i.nocheck,i.nocheck=!0),i.check_Child_State=-1,t.repairParentChkClassWithSelf&&t.repairParentChkClassWithSelf(e,i))},initShowForExCheck:function(e,i){if(!o.isHidden(e,i)&&e.check&&e.check.enable){if("undefined"!=typeof i._nocheck&&(i.nocheck=i._nocheck,delete i._nocheck),t.setChkClass){var s=n(i,d.id.CHECK,e);t.setChkClass(e,s,i)}t.repairParentChkClassWithSelf&&t.repairParentChkClassWithSelf(e,i)}}}});var e=e.fn.zTree,i=e._z.tools,d=e.consts,t=e._z.view,o=e._z.data,n=i.$;o.isHidden=function(e,d,t){return d?(e=e.data.key.isHidden,"undefined"!=typeof t&&("string"==typeof t&&(t=i.eqs(checked,"true")),d[e]=!!t),d[e]):!1},o.exSetting({data:{key:{isHidden:"isHidden"}}}),o.addInitNode(function(e,i,d){i=o.isHidden(e,d),o.isHidden(e,d,i),o.initHideForExCheck(e,d)}),o.addBeforeA(function(){}),o.addZTreeTools(function(e,i){i.showNodes=function(i,d){t.showNodes(e,i,d)},i.showNode=function(i,d){i&&t.showNodes(e,[i],d)},i.hideNodes=function(i,d){t.hideNodes(e,i,d)},i.hideNode=function(i,d){i&&t.hideNodes(e,[i],d)};var d=i.checkNode;d&&(i.checkNode=function(t){(!t||!o.isHidden(e,t))&&d.apply(i,arguments)})});var s=o.initNode;o.initNode=function(e,i,d,n,r,a,N){var c=(n?n:o.getRoot(e))[e.data.key.children];o.tmpHideFirstNode=t.setFirstNodeForHide(e,c),o.tmpHideLastNode=t.setLastNodeForHide(e,c),N&&(t.setNodeLineIcos(e,o.tmpHideFirstNode),t.setNodeLineIcos(e,o.tmpHideLastNode)),r=o.tmpHideFirstNode===d,a=o.tmpHideLastNode===d,s&&s.apply(o,arguments),N&&a&&t.clearOldLastNode(e,d,N)};var r=o.makeChkFlag;r&&(o.makeChkFlag=function(e,i){(!i||!o.isHidden(e,i))&&r.apply(o,arguments)});var a=o.getTreeCheckedNodes;a&&(o.getTreeCheckedNodes=function(e,i){if(i&&i.length>0){var d=i[0].getParentNode();if(d&&o.isHidden(e,d))return[]}return a.apply(o,arguments)});var N=o.getTreeChangeCheckedNodes;N&&(o.getTreeChangeCheckedNodes=function(e,i){if(i&&i.length>0){var d=i[0].getParentNode();if(d&&o.isHidden(e,d))return[]}return N.apply(o,arguments)});var c=t.expandCollapseSonNode;c&&(t.expandCollapseSonNode=function(e,i){(!i||!o.isHidden(e,i))&&c.apply(t,arguments)});var h=t.setSonNodeCheckBox;h&&(t.setSonNodeCheckBox=function(e,i){(!i||!o.isHidden(e,i))&&h.apply(t,arguments)});var f=t.repairParentChkClassWithSelf;f&&(t.repairParentChkClassWithSelf=function(e,i){(!i||!o.isHidden(e,i))&&f.apply(t,arguments)})}(jQuery);