function searchContractUpload(a){var e=$("#approve_date_begin").val().trim(),t=$("#approve_date_end").val().trim();if(!checkDate(e,t))return void layer.msg("审批通过日期开始日期不得大于截止日期！");var r=$("#scanCpyQueryTable").DataTable();a?r.ajax.reload(null,!1):r.ajax.reload()}function exportScanCpyList(){var a=getSearchParm(),e=serverPath+"contractScanQuery/contractExportList"+App.urlEncode(a);location.href=encodeURI(e)}function getSearchParm(){var a={contractNumber:$("#contractNumber").val().trim(),contractName:$("#contractName").val().trim(),approveDateBegin:$("#approve_date_begin").val().trim(),approveDateEnd:$("#approve_date_end").val().trim()};return $("#oppoPartyName").data("exactSearch")?a.oppoPartyId=$("#oppoPartyName").data("partnerId"):a.oppoPartyName=$("#oppoPartyName").val().trim(),$("#unicomPartyName").data("exactSearch")?a.unicomPartyId=$("#unicomPartyName").data("partnerId"):a.unicomPartyName=$("#unicomPartyName").val().trim(),$("#undertakeName").data("exactSearch")?a.undertakerId=$("#undertakeName").data("staffOrgId"):a.undertakeName=$("#undertakeName").val().trim(),$("#executeDeptName").data("exactSearch")?a.executeDeptId=$("#executeDeptName").data("orgId"):a.executeDeptName=$("#executeDeptName").val().trim(),a}function jumpSanCpyQueryDetail(a){var e="./scanCpyQueryDetail.html?id="+a;App.changePresentUrl(e)}function getScanCpyConract(a){function e(a){var e=a.data;e?window.location.href=serverPath+"fileload/downloadS3?key="+e:layer.msg("获取不到下载key值！")}var t=serverPath+"contractScanQuery/downloadContractText",r={id:a,fileType:"905510"};App.formAjaxJson(t,"get",r,e)}function checkDate(a,e){var t=new Date(a),r=new Date(e);return Date.parse(t)-Date.parse(r)>0?!1:!0}var config=top.globalConfig,serverPath=config.serverPath;App.initDataTables("#scanCpyQueryTable","#submitBtn",{ajax:{type:"POST",contentType:"application/json;charset=utf-8",url:serverPath+"contractScanQuery/contractScanQueryList",data:function(a){var e=getSearchParm();return a=$.extend(a,e),JSON.stringify(a)}},columns:[{data:null,title:"序号",className:"text-center",render:function(a,e,t,r){var n=App.getDatatablePaging("#scanCpyQueryTable").pageStart;return n+r.row+1}},{data:"contractName",title:"合同名称",className:"whiteSpaceNormal",width:"25%"},{data:"contractNumber",title:"合同编号",className:"whiteSpaceNormal",width:"15%"},{data:"executeDeptName",title:"承办部门",className:"whiteSpaceNormal",width:"13%"},{data:"undertakeName",title:"承办人"},{data:"unicomPartyName",title:"我方主体",className:"whiteSpaceNormal",width:"15%"},{data:"oppoPartyName",title:"对方主体",className:"whiteSpaceNormal",width:"15%"},{data:"approveDate",title:"审批通过时间",render:function(a){return App.formatDateTime(a,"yyyy-MM-dd")}},{data:"id",className:"text-center",title:"快捷下载",render:function(a,e,t){var r="<a onclick=\"getScanCpyConract('"+t.id+"')\">正文下载</a>";return r}},{data:null,className:"text-center",title:"操作",render:function(a){if(a){var e=new Array;return e.push({name:"打开",fn:"jumpSanCpyQueryDetail('"+a.id+"')",icon:"iconfont icon-add"}),App.getDataTableBtn(e)}return""}}],columnDefs:[{createdCell:function(a,e,t,r,n){n>0&&9>n&&$(a).attr("title",$(a).text())}}]}),$(function(){$("#searchOppoParty").click(function(){App.getCommonModal("otherSubject","#oppoPartyName","partnerName","partnerId")}),$("#searchUnicomParty").click(function(){App.getCommonModal("ourSubject","#unicomPartyName","partnerName","partnerId")}),$("#searchUndertaker").click(function(){App.getCommonModal("agentStaff","#undertakeName","name","staffOrgId")}),$("#searchexecuteDept").click(function(){App.getCommonModal("agentDepartment","#executeDeptName","orgName","orgId")}),$("#oppoPartyName").on("change",function(){$(this).data("exactSearch",!1)}),$("#unicomPartyName").on("change",function(){$(this).data("exactSearch",!1)}),$("#undertakeName").on("change",function(){$(this).data("exactSearch",!1)}),$("#executeDeptName").on("change",function(){$(this).data("exactSearch",!1)})});