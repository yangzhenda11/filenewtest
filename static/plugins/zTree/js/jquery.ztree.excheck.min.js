!function(e){var t,c,h,n={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},a={check:{enable:!1,autoCheckTrigger:!1,chkStyle:n.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:n.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}};t=function(e,t){if(t.chkDisabled===!0)return!1;var c=k.getSetting(e.data.treeId);if(0==i.apply(c.callback.beforeCheck,[c.treeId,t],!0))return!0;var h=k.nodeChecked(c,t);return k.nodeChecked(c,t,!h),d.checkNodeRelation(c,t),h=o(t,r.id.CHECK,c),d.setChkClass(c,h,t),d.repairParentChkClassWithSelf(c,t),c.treeObj.trigger(r.event.CHECK,[e,c.treeId,t]),!0},c=function(e,t){if(t.chkDisabled===!0)return!1;var c=k.getSetting(e.data.treeId),h=o(t,r.id.CHECK,c);return t.check_Focus=!0,d.setChkClass(c,h,t),!0},h=function(e,t){if(t.chkDisabled===!0)return!1;var c=k.getSetting(e.data.treeId),h=o(t,r.id.CHECK,c);return t.check_Focus=!1,d.setChkClass(c,h,t),!0},e.extend(!0,e.fn.zTree.consts,n),e.extend(!0,e.fn.zTree._z,{tools:{},view:{checkNodeRelation:function(e,t){var c,h,n;if(h=r.radio,c=k.nodeChecked(e,t),e.check.chkStyle==h.STYLE){var a=k.getRadioCheckedList(e);if(c)if(e.check.radioType==h.TYPE_ALL){for(h=a.length-1;h>=0;h--){c=a[h];var i=k.nodeChecked(e,c);i&&c!=t&&(k.nodeChecked(e,c,!1),a.splice(h,1),d.setChkClass(e,o(c,r.id.CHECK,e),c),c.parentTId!=t.parentTId&&d.repairParentChkClassWithSelf(e,c))}a.push(t)}else for(a=t.parentTId?t.getParentNode():k.getRoot(e),a=k.nodeChildren(e,a),h=0,n=a.length;n>h;h++)c=a[h],(i=k.nodeChecked(e,c))&&c!=t&&(k.nodeChecked(e,c,!1),d.setChkClass(e,o(c,r.id.CHECK,e),c));else if(e.check.radioType==h.TYPE_ALL)for(h=0,n=a.length;n>h;h++)if(t==a[h]){a.splice(h,1);break}}else a=k.nodeChildren(e,t),c&&(!a||0==a.length||e.check.chkboxType.Y.indexOf("s")>-1)&&d.setSonNodeCheckBox(e,t,!0),!c&&(!a||0==a.length||e.check.chkboxType.N.indexOf("s")>-1)&&d.setSonNodeCheckBox(e,t,!1),c&&e.check.chkboxType.Y.indexOf("p")>-1&&d.setParentNodeCheckBox(e,t,!0),!c&&e.check.chkboxType.N.indexOf("p")>-1&&d.setParentNodeCheckBox(e,t,!1)},makeChkClass:function(e,t){var c=r.checkbox,h=r.radio,n="",a=k.nodeChecked(e,t),n=t.chkDisabled===!0?c.DISABLED:t.halfCheck?c.PART:e.check.chkStyle==h.STYLE?t.check_Child_State<1?c.FULL:c.PART:a?2===t.check_Child_State||-1===t.check_Child_State?c.FULL:c.PART:t.check_Child_State<1?c.FULL:c.PART,h=e.check.chkStyle+"_"+(a?c.TRUE:c.FALSE)+"_"+n,h=t.check_Focus&&t.chkDisabled!==!0?h+"_"+c.FOCUS:h;return r.className.BUTTON+" "+c.DEFAULT+" "+h},repairAllChk:function(e,t){if(e.check.enable&&e.check.chkStyle===r.checkbox.STYLE)for(var c=k.getRoot(e),c=k.nodeChildren(e,c),h=0,n=c.length;n>h;h++){var a=c[h];a.nocheck!==!0&&a.chkDisabled!==!0&&k.nodeChecked(e,a,t),d.setSonNodeCheckBox(e,a,t)}},repairChkClass:function(e,t){if(t&&(k.makeChkFlag(e,t),t.nocheck!==!0)){var c=o(t,r.id.CHECK,e);d.setChkClass(e,c,t)}},repairParentChkClass:function(e,t){if(t&&t.parentTId){var c=t.getParentNode();d.repairChkClass(e,c),d.repairParentChkClass(e,c)}},repairParentChkClassWithSelf:function(e,t){if(t){var c=k.nodeChildren(e,t);c&&c.length>0?d.repairParentChkClass(e,c[0]):d.repairParentChkClass(e,t)}},repairSonChkDisabled:function(e,t,c,h){if(t&&(t.chkDisabled!=c&&(t.chkDisabled=c),d.repairChkClass(e,t),(t=k.nodeChildren(e,t))&&h))for(var n=0,a=t.length;a>n;n++)d.repairSonChkDisabled(e,t[n],c,h)},repairParentChkDisabled:function(e,t,c,h){t&&(t.chkDisabled!=c&&h&&(t.chkDisabled=c),d.repairChkClass(e,t),d.repairParentChkDisabled(e,t.getParentNode(),c,h))},setChkClass:function(e,t,c){t&&(c.nocheck===!0?t.hide():t.show(),t.attr("class",d.makeChkClass(e,c)))},setParentNodeCheckBox:function(e,t,c,h){var n=o(t,r.id.CHECK,e);if(h||(h=t),k.makeChkFlag(e,t),t.nocheck!==!0&&t.chkDisabled!==!0&&(k.nodeChecked(e,t,c),d.setChkClass(e,n,t),e.check.autoCheckTrigger&&t!=h&&e.treeObj.trigger(r.event.CHECK,[null,e.treeId,t])),t.parentTId){if(n=!0,!c)for(var a=k.nodeChildren(e,t.getParentNode()),i=0,s=a.length;s>i;i++){var l=a[i],C=k.nodeChecked(e,l);if(l.nocheck!==!0&&l.chkDisabled!==!0&&C||(l.nocheck===!0||l.chkDisabled===!0)&&l.check_Child_State>0){n=!1;break}}n&&d.setParentNodeCheckBox(e,t.getParentNode(),c,h)}},setSonNodeCheckBox:function(e,t,c,h){if(t){var n=o(t,r.id.CHECK,e);h||(h=t);var a=!1,i=k.nodeChildren(e,t);if(i)for(var s=0,l=i.length;l>s;s++){var C=i[s];d.setSonNodeCheckBox(e,C,c,h),C.chkDisabled===!0&&(a=!0)}t!=k.getRoot(e)&&t.chkDisabled!==!0&&(a&&t.nocheck!==!0&&k.makeChkFlag(e,t),t.nocheck!==!0&&t.chkDisabled!==!0?(k.nodeChecked(e,t,c),a||(t.check_Child_State=i&&i.length>0?c?2:0:-1)):t.check_Child_State=-1,d.setChkClass(e,n,t),e.check.autoCheckTrigger&&t!=h&&t.nocheck!==!0&&t.chkDisabled!==!0&&e.treeObj.trigger(r.event.CHECK,[null,e.treeId,t]))}}},event:{},data:{getRadioCheckedList:function(e){for(var t=k.getRoot(e).radioCheckedList,c=0,h=t.length;h>c;c++)k.getNodeCache(e,t[c].tId)||(t.splice(c,1),c--,h--);return t},getCheckStatus:function(e,t){if(!e.check.enable||t.nocheck||t.chkDisabled)return null;var c=k.nodeChecked(e,t);return{checked:c,half:t.halfCheck?t.halfCheck:e.check.chkStyle==r.radio.STYLE?2===t.check_Child_State:c?t.check_Child_State>-1&&t.check_Child_State<2:t.check_Child_State>0}},getTreeCheckedNodes:function(e,t,c,h){if(!t)return[];for(var n=c&&e.check.chkStyle==r.radio.STYLE&&e.check.radioType==r.radio.TYPE_ALL,h=h?h:[],a=0,i=t.length;i>a;a++){var d=t[a],o=k.nodeChildren(e,d),s=k.nodeChecked(e,d);if(d.nocheck!==!0&&d.chkDisabled!==!0&&s==c&&(h.push(d),n))break;if(k.getTreeCheckedNodes(e,o,c,h),n&&h.length>0)break}return h},getTreeChangeCheckedNodes:function(e,t,c){if(!t)return[];for(var c=c?c:[],h=0,n=t.length;n>h;h++){var a=t[h],i=k.nodeChildren(e,a),r=k.nodeChecked(e,a);a.nocheck!==!0&&a.chkDisabled!==!0&&r!=a.checkedOld&&c.push(a),k.getTreeChangeCheckedNodes(e,i,c)}return c},makeChkFlag:function(e,t){if(t){var c=-1,h=k.nodeChildren(e,t);if(h)for(var n=0,a=h.length;a>n;n++){var i=h[n],d=k.nodeChecked(e,i),o=-1;if(e.check.chkStyle==r.radio.STYLE){if(o=i.nocheck===!0||i.chkDisabled===!0?i.check_Child_State:i.halfCheck===!0?2:d?2:i.check_Child_State>0?2:0,2==o){c=2;break}0==o&&(c=0)}else if(e.check.chkStyle==r.checkbox.STYLE){if(o=i.nocheck===!0||i.chkDisabled===!0?i.check_Child_State:i.halfCheck===!0?1:d?-1===i.check_Child_State||2===i.check_Child_State?2:1:i.check_Child_State>0?1:0,1===o){c=1;break}if(2===o&&c>-1&&n>0&&o!==c){c=1;break}if(2===c&&o>-1&&2>o){c=1;break}o>-1&&(c=o)}}t.check_Child_State=c}}}});var e=e.fn.zTree,i=e._z.tools,r=e.consts,d=e._z.view,k=e._z.data,o=i.$;k.nodeChecked=function(e,t,c){return t?(e=e.data.key.checked,"undefined"!=typeof c&&("string"==typeof c&&(c=i.eqs(c,"true")),t[e]=!!c),t[e]):!1},k.exSetting(a),k.addInitBind(function(e){e.treeObj.bind(r.event.CHECK,function(t,c,h,n){t.srcEvent=c,i.apply(e.callback.onCheck,[t,h,n])})}),k.addInitUnBind(function(e){e.treeObj.unbind(r.event.CHECK)}),k.addInitCache(function(){}),k.addInitNode(function(e,t,c,h){c&&(t=k.nodeChecked(e,c),t=k.nodeChecked(e,c,t),c.checkedOld=t,"string"==typeof c.nocheck&&(c.nocheck=i.eqs(c.nocheck,"true")),c.nocheck=!!c.nocheck||e.check.nocheckInherit&&h&&!!h.nocheck,"string"==typeof c.chkDisabled&&(c.chkDisabled=i.eqs(c.chkDisabled,"true")),c.chkDisabled=!!c.chkDisabled||e.check.chkDisabledInherit&&h&&!!h.chkDisabled,"string"==typeof c.halfCheck&&(c.halfCheck=i.eqs(c.halfCheck,"true")),c.halfCheck=!!c.halfCheck,c.check_Child_State=-1,c.check_Focus=!1,c.getCheckStatus=function(){return k.getCheckStatus(e,c)},e.check.chkStyle==r.radio.STYLE&&e.check.radioType==r.radio.TYPE_ALL&&t&&k.getRoot(e).radioCheckedList.push(c))}),k.addInitProxy(function(e){var n=e.target,a=k.getSetting(e.data.treeId),d="",o=null,s="",l=null;if(i.eqs(e.type,"mouseover")?a.check.enable&&i.eqs(n.tagName,"span")&&null!==n.getAttribute("treeNode"+r.id.CHECK)&&(d=i.getNodeMainDom(n).id,s="mouseoverCheck"):i.eqs(e.type,"mouseout")?a.check.enable&&i.eqs(n.tagName,"span")&&null!==n.getAttribute("treeNode"+r.id.CHECK)&&(d=i.getNodeMainDom(n).id,s="mouseoutCheck"):i.eqs(e.type,"click")&&a.check.enable&&i.eqs(n.tagName,"span")&&null!==n.getAttribute("treeNode"+r.id.CHECK)&&(d=i.getNodeMainDom(n).id,s="checkNode"),d.length>0)switch(o=k.getNodeCache(a,d),s){case"checkNode":l=t;break;case"mouseoverCheck":l=c;break;case"mouseoutCheck":l=h}return{stop:"checkNode"===s,node:o,nodeEventType:s,nodeEventCallback:l,treeEventType:"",treeEventCallback:null}},!0),k.addInitRoot(function(e){k.getRoot(e).radioCheckedList=[]}),k.addBeforeA(function(e,t,c){e.check.enable&&(k.makeChkFlag(e,t),c.push("<span ID='",t.tId,r.id.CHECK,"' class='",d.makeChkClass(e,t),"' treeNode",r.id.CHECK,t.nocheck===!0?" style='display:none;'":"","></span>"))}),k.addZTreeTools(function(e,t){t.checkNode=function(t,c,h,n){var a=k.nodeChecked(e,t);t.chkDisabled===!0||(c!==!0&&c!==!1&&(c=!a),n=!!n,a===c&&!h||n&&0==i.apply(this.setting.callback.beforeCheck,[this.setting.treeId,t],!0)||!i.uCanDo(this.setting)||!this.setting.check.enable||t.nocheck===!0)||(k.nodeChecked(e,t,c),c=o(t,r.id.CHECK,this.setting),(h||this.setting.check.chkStyle===r.radio.STYLE)&&d.checkNodeRelation(this.setting,t),d.setChkClass(this.setting,c,t),d.repairParentChkClassWithSelf(this.setting,t),n&&this.setting.treeObj.trigger(r.event.CHECK,[null,this.setting.treeId,t]))},t.checkAllNodes=function(e){d.repairAllChk(this.setting,!!e)},t.getCheckedNodes=function(t){var t=t!==!1,c=k.nodeChildren(e,k.getRoot(this.setting));return k.getTreeCheckedNodes(this.setting,c,t)},t.getChangeCheckedNodes=function(){var t=k.nodeChildren(e,k.getRoot(this.setting));return k.getTreeChangeCheckedNodes(this.setting,t)},t.setChkDisabled=function(e,t,c,h){t=!!t,c=!!c,d.repairSonChkDisabled(this.setting,e,t,!!h),d.repairParentChkDisabled(this.setting,e.getParentNode(),t,c)};var c=t.updateNode;t.updateNode=function(e,h){if(c&&c.apply(t,arguments),e&&this.setting.check.enable&&o(e,this.setting).get(0)&&i.uCanDo(this.setting)){var n=o(e,r.id.CHECK,this.setting);(1==h||this.setting.check.chkStyle===r.radio.STYLE)&&d.checkNodeRelation(this.setting,e),d.setChkClass(this.setting,n,e),d.repairParentChkClassWithSelf(this.setting,e)}}});var s=d.createNodes;d.createNodes=function(e,t,c,h){s&&s.apply(d,arguments),c&&d.repairParentChkClassWithSelf(e,h)};var l=d.removeNode;d.removeNode=function(e,t){var c=t.getParentNode();l&&l.apply(d,arguments),t&&c&&(d.repairChkClass(e,c),d.repairParentChkClass(e,c))};var C=d.appendNodes;d.appendNodes=function(e,t,c,h){var n="";return C&&(n=C.apply(d,arguments)),h&&k.makeChkFlag(e,h),n}}(jQuery);