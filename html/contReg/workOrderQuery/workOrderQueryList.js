function searchWorkOrder(t){var a=$("#create_date_begin").val().trim(),e=$("#create_date_end").val().trim(),r=$("#approve_date_begin").val().trim(),c=$("#approve_date_end").val().trim(),n=$("#sealAndSign_date_begin").val().trim(),i=$("#sealAndSign_date_end").val().trim();if(!checkDate(a,e))return void layer.msg("工单创建日期开始日期不得大于截止日期！");if(!checkDate(r,c))return void layer.msg("合同审批通过日期开始日期不得大于截止日期！");if(!checkDate(n,i))return void layer.msg("签订盖章日期开始日期不得大于截止日期！");var o=$("#workOrderQueryTable").DataTable();t?o.ajax.reload(null,!1):o.ajax.reload()}function getSearchParm(){var t={contractNumber:$("#contractNumber").val().trim(),contractName:$("#contractName").val().trim(),wcardStatus:$("#wcardStatus").val().trim(),wcardNumber:$("#wcardNumber").val().trim(),contractOrganitzation:$("#contractOrganitzation").val().trim(),ctreatedDateBegin:$("#create_date_begin").val().trim(),ctreatedDateEnd:$("#create_date_end").val().trim(),approveDateBegin:$("#approve_date_begin").val().trim(),approveDateEnd:$("#approve_date_end").val().trim(),sealAndSignDateBegin:$("#sealAndSign_date_begin").val().trim(),sealAndSignDateEnd:$("#sealAndSign_date_end").val().trim()};return $("#contractType").data("exactSearch")?t.contractType=$("#contractType").data("typeCode"):t.contractTypeName=$("#contractType").val().trim(),$("#otherSubject").data("exactSearch")?t.oppoPartyId=$("#otherSubject").data("partnerId"):t.oppoPartyName=$("#otherSubject").val().trim(),$("#ourSubject").data("exactSearch")?t.unicomPartyId=$("#ourSubject").data("partnerId"):t.unicomPartyName=$("#ourSubject").val().trim(),$("#agentStaff").data("exactSearch")?t.undertakerId=$("#agentStaff").data("staffOrgId"):t.undertakeName=$("#agentStaff").val().trim(),$("#agentDepartment").data("exactSearch")?t.executeDeptId=$("#agentDepartment").data("orgId"):t.executeDeptName=$("#agentDepartment").val().trim(),t}function exportResultExcel(){var t=getSearchParm(),a=serverPath+"workOrderQuery/workOrderQueryExpoetList"+App.urlEncode(t);location.href=encodeURI(a)}function checkDate(t,a){var e=new Date(t),r=new Date(a);return Date.parse(e)-Date.parse(r)>0?!1:!0}var config=top.globalConfig,serverPath=config.serverPath,ajaxObj={url:serverPath+"dicts/listChildrenByDicttId",type:"post",data:{dictId:9040}};App.initAjaxSelect2("#wcardStatus",ajaxObj,"dictValue","dictLabel","请选择工单状态"),App.initDataTables("#workOrderQueryTable","#submitBtn",{ajax:{type:"POST",contentType:"application/json;charset=utf-8",url:serverPath+"workOrderQuery/workOrderQueryList",data:function(t){var a=getSearchParm();return t=$.extend(t,a),JSON.stringify(t)}},columns:[{data:null,title:"序号",className:"text-center",width:"3%",render:function(t,a,e,r){var c=App.getDatatablePaging("#workOrderQueryTable").pageStart;return c+r.row+1}},{data:"contractName",title:"合同名称",className:"whiteSpaceNormal",width:"15%"},{data:"contractNumber",title:"合同编号",className:"whiteSpaceNormal",width:"10%"},{data:"contractTypeName",title:"合同类型",className:"whiteSpaceNormal",width:"15%"},{data:"wcardNumber",className:"whiteSpaceNormal",title:"工单编号",width:"10%",render:function(t,a,e){var r='<a href="../workOrderEdit/workOrderEdit.html?pageType=4&taskFlag=yb&taskDefinitionKey=GDQR&wcardId='+e.wcardId+'">'+t+"</a>";return r}},{data:"wcardStatusStr",title:"工单状态",width:"5%",className:"whiteSpaceNormal"},{data:"ctreatedDate",title:"创建日期",width:"5%",className:"whiteSpaceNormal",render:function(t){return App.formatDateTime(t,"yyyy-MM-dd")}},{data:"undertakeName",title:"承办人",className:"whiteSpaceNormal",width:"6%"},{data:"unicomPartyId",bVisible:!1,title:"我方主体"},{data:"unicomPartyName",title:"我方主体",className:"whiteSpaceNormal",width:"15%"},{data:"oppoPartyId",bVisible:!1,title:"对方主体"},{data:"oppoPartyName",title:"对方主体",className:"whiteSpaceNormal",width:"15%"}],columnDefs:[{createdCell:function(t,a,e,r,c){c>0&&$(t).attr("title",$(t).text())}}]}),$(function(){$("#searchContractType").click(function(){App.getCommonModal("contractType","#contractType","typeFullname","typeCode")}),$("#searchAgentStaff").click(function(){App.getCommonModal("agentStaff","#agentStaff","name","staffOrgId")}),$("#searchAgentDepartment").click(function(){App.getCommonModal("agentDepartment","#agentDepartment","orgName","orgId")}),$("#searchOurSubject").click(function(){App.getCommonModal("ourSubject","#ourSubject","partnerName","partnerId")}),$("#searchOtherSubject").click(function(){App.getCommonModal("otherSubject","#otherSubject","partnerName","partnerId")}),$("#contractType").on("change",function(){$(this).data("exactSearch",!1)}),$("#agentStaff").on("change",function(){$(this).data("exactSearch",!1)}),$("#agentDepartment").on("change",function(){$(this).data("exactSearch",!1)}),$("#ourSubject").on("change",function(){$(this).data("exactSearch",!1)}),$("#otherSubject").on("change",function(){$(this).data("exactSearch",!1)})});