<div class="form-fieldset">
	<div class="form-fieldset-title">
		<span><i class="iconfont icon-layers"></i> 合同扫描件列表</span>
		<div class="form-fieldset-tools">
			<a href="#" class="form-collapse"><i class="fa fa-angle-up"></i></a>
		</div>
	</div>
	<div class="form-fieldset-body">
		<div class="row">
			<div class="portlet">
                <div class="portlet-title ">
                    <div class="caption font-dark">
                        <span class="caption-subject bold uppercase">合同正文扫描件</span>
                    </div>
                </div>
                <div class="portlet-body">
                    <table class='table table-hover table-bordered table-striped table-align'>
						<thead>
							<tr>
								<th>序号</th>
								<th>文件列表</th>
								<th>上传日期</th>
								<th>上传人</th>
							</tr>
						</thead>
						<tbody id="contractMainTextTbody">
							<tr><td colspan="4">暂无合同正文扫描件信息</td></tr>
						</tbody>
					</table>
            	</div>
       	    </div>
       	    <div class="portlet">
                <div class="portlet-title ">
                    <div class="caption font-dark">
                        <span class="caption-subject bold uppercase">合同附件扫描件</span>
                    </div>
                </div>
                <div class="portlet-body">
                    <table class='table table-hover table-bordered table-striped table-align'>
						<thead>
							<tr>
								<th>序号</th>
								<th>文件列表</th>
								<th>上传日期</th>
								<th>上传人</th>
							</tr>
						</thead>
						<tbody id="contractAttachmentDocTbody">
							<tr><td colspan="4">暂无合同附件扫描件信息</td></tr>
						</tbody>
					</table>
            	</div>
       	    </div>
		</div>
	</div>
</div>
<script type="text/javascript">
	//获取合同扫描件ID来获取合同扫描件
	getContractScandocId()
	
	/*
	 * 获取合同扫描件ID来获取合同扫描件
	 */
	function getContractScandocId(){
		var url = serverPath + 'contractOrderEditorController/getScanningID';
		var postData = {
			contractId : contractId
		}
		App.formAjaxJson(url, "get", postData, successCallback);
		function successCallback(result) {
			var scandocId = result.data.scandocId;
			if(scandocId){
				//获取合同正文扫描件
				getContarctScanCopyContractText(scandocId);
				//获取合同附件扫描件
				getContarctScanCopyContractAttachment(scandocId);
			}else{
				layer.msg("获取合同扫描件主键ID失败");
			}
		}
	}
	/*
	 * 获取合同正文扫描件
	 */
	function getContarctScanCopyContractText(scandocId){
		var url = serverPath + 'contractScanQuery/listContractText?id=' + scandocId;
		App.formAjaxJson(url, "post", null, successCallback);
		function successCallback(result) {
			var data = result.data;
			if(data.length > 0){
				var html = "";
				for(var i = 0; i < data.length; i++){
					html += "<tr>"+"<td>"+ (i+1) +"</td>";
					if(data[i].storeIdDisplay && data[i].storeIdDisplay != "0"){
						html += "<td><a href='"+serverPath+"fileload/downloadS3?key="+data[i].storeIdDisplay+"'>"+ data[i].displayName+"</td>";
					}else{
						html += "<td>"+ data[i].displayName+"</td>";
					};
					html += "<td>"+ App.formatDateTime(data[i].ctreatedDate,"yyyy-MM-dd") +"</td>"+
							"<td>"+ data[i].createdByName +"</td></tr>";
				}
				$("#contractMainTextTbody").html(html);
			}
		}
	}
	/*
	 * 获取合同附件扫描件
	 */
	function getContarctScanCopyContractAttachment(scandocId){
		var url = serverPath + 'contractScanQuery/listContractAttachment?id=' + scandocId;
		App.formAjaxJson(url, "post", null, successCallback);
		function successCallback(result) {
			var data = result.data;
			if(data.length > 0){
				var html = "";
				for(var i = 0; i < data.length; i++){
					html += "<tr>"+"<td>"+ (i+1) +"</td>";
					if(data[i].storeIdDisplay && data[i].storeIdDisplay != "0"){
						html += "<td><a href='"+serverPath+"fileload/downloadS3?key="+data[i].storeIdDisplay+"'>"+ data[i].displayName+"</td>";
					}else{
						html += "<td>"+ data[i].displayName+"</td>";
					};
					html += "<td>"+ App.formatDateTime(data[i].ctreatedDate,"yyyy-MM-dd") +"</td>"+
							"<td>"+ data[i].createdByName +"</td></tr>";
				}
				$("#contractAttachmentDocTbody").html(html);
			}
		}
	}	
</script>