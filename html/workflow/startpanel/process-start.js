function refreshLinkForSart(){var e=$("#processDefinitionKey").val(),a=$("#pathSelect").val();if(0==e.length)return void layer.alert("请选择流程模板！");var t=setRelativeData();t||(t=null),$.get(serverPath+"workflowrest/tasklinkforstart/"+e+"/0/"+a,t,function(e){var a=e.retCode;if(1==a){var t=e.dataRows;$("#linkForStart").empty(),$.each(t,function(e,a){$("#linkForStart").append("<option value='"+a.value+"'>"+a.label+"</option>")}),clearAssigneeForStart(),$("#myProcessStartModal").modal("show")}else 0==a&&alert(e.retVal)})}function refreshAssigneeForStart(e,a,t){$.post(e+"/workflowrest/assigneeforstart/"+a+"/"+t,function(e){var a=e.retCode;if(1==a){var t=e.dataRows;$("#assigneeForStart").empty(),$.each(t,function(e,a){$("#assigneeForStart").append("<option value='"+a.value+"'>"+a.label+"</option>")})}else 0==a&&alert(e.retValue)})}function startProcess(e,a,t,r){if(0==e.length)return void layer.msg("请选择办理环节！",{time:2e3});if(null==a||0==a.length)return void layer.msg("请选择处理人！",{time:2e3});var n=$("#comment").val();if(null==n||0==n.length)return void layer.msg("请填写处理意见！",{time:2e3});var o=$("#linkForStart").val().toString().split(",")[3];return null==o||0==o.length?void layer.msg("流程异常，无法识别下一步环节是否是需要抢单环节，请联系管理员！",{time:2e3}):void layer.confirm("是否确认提交？",{icon:3,title:"确认"},function(s){modal_start(e,a,t,n,r,o),layer.close(s)})}function showStartPanel(){refreshLinkForSart()}function clearAssigneeForStart(){$("#assigneeForStart").val(""),$("#assigneeNameForStart").val("")}function closeModalForStart(){$("#myProcessStartModal").modal("hide")}function selectstaff(){var e=$("#processDefinitionKey").val(),a=$("#linkForStart").val().toString().split(",")[0],t=$("#linkForStart").val().toString().split(",")[3],r=$("#wprov").val(),n=$("#wStaffSelectType").val(),o="getassignee";1==t&&(layer.msg("因下一步环节是候选人抢单环节，所以强制切换选人模式为多选！"),n=2),2==n&&(o="getassignees"),jandyStaffSearch(e,a,r,o,n)}function jandyStaffSearch(e,a,t,r,n){var o="/html/workflow/assignee/assgigneeList.html?"+App.timestamp();$("#PandJstaffiframetask").load(o,function(){$("#PandJstaffiframetask").modal("show"),setParam(e,a,t,r,n),$("#PandJstaffiframetask").off("shown.bs.modal").on("shown.bs.modal",function(){App.initDataTables("#searchStaffTable","#searchEforgHome",dataTableConfig),$(".checkall").click(function(){var e=$(this).prop("checked");$(".checkchild").prop("checked",e)})})})}function getassignee(e,a,t,r,n){$("#assigneeForStart").val(n),$("#assigneeNameForStart").val(r),$("#PandJstaffiframetask").modal("hide")}function getassignees(e,a){$("#assigneeForStart").val(e),$("#assigneeNameForStart").val(a),$("#PandJstaffiframetask").modal("hide")}function setAssigneeParam(e){$("#wprov").val(e.prov)}function getProcessDefinitionKey(e){$.ajax({type:"post",url:serverPath+"workflowrest/getprocessDefinitionKey/"+e,async:!1,success:function(e){var a=e.retCode;if(1==a){var t=e.dataRows[0].processDefinitionKey;$("#processDefinitionKey").val(t)}else 0==a&&layer.msg(e.retVal,{time:3e3})},error:function(e){App.ajaxErrorCallback(e)}})}function setPathSelect(e){$("#pathSelect").val(e)}function setStaffSelectType(e){e.length>0&&$("#wStaffSelectType").val(e)}var config=parent.globalConfig,serverPath=config.serverPath,curStaffOrgId=config.curStaffOrgId,curStaffId=config.curStaffId;