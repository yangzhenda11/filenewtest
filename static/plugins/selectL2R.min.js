var selectL2R = function() {
	function e(e) {
		var n, i = $(e).find(".selectL").children(),
			t = $(e).find(".selectR").children();
		"TABLE" == i[0].nodeName ? n = "tbody tr" : "UL" == i[0].nodeName && (n = "li");
		var s = [];
		return t.find(n).each(function() {
			var e = $(this).data("id");
			s.push(e)
		}), s
	};
	function r(e) {
		var n, i = $(e).find(".selectL").children(),
			t = $(e).find(".selectR").children();
		"TABLE" == i[0].nodeName ? n = "tbody tr" : "UL" == i[0].nodeName && (n = "li");
		var s = [];
		return t.find(n).each(function() {
			var e = $(this).data("id");
			var t = $(this).text();
			s.push({id:e,data:t});
		}), s
	}
	var n = function(e, n) {
		function i(e) {
			a.find(s + "." + o).each(function() {
				$(this).data("id") == e && $(this).removeClass(o)
			})
		}

		function t() {
			"tbody tr" == s && l.find(s).each(function(e) {
				$(this).find("td:first").text(e + 1)
			})
		}
		var s, a = $(e).find(".selectL").children(),
			l = $(e).find(".selectR").children(),
			d = $(e).find(".selectL2R-actions"),
			c = "warning",
			o = "success";
		if("TABLE" == a[0].nodeName ? (s = "tbody tr", $selNode = a.find("tr")) : "UL" == a[0].nodeName && (s = "li", c = "list-group-item-" + c, o = "list-group-item-" + o), a.find(s).on("click", function() {
				var e = $(this);
				e.hasClass(c) ? e.removeClass(c) : e.hasClass(o) || e.addClass(c)
			}), l.delegate(s, "click", function() {
				var e = $(this);
				e.hasClass(c) ? e.removeClass(c) : e.addClass(c)
			}), d.find(".selectL2R-select").on("click", function() {
				var e = a.find(s + "." + c);
				if(0 == e.length){
					layer.msg("请先在左侧列表中选择要选择的内容");
				} 
				else {
					var n = e.removeClass(c).clone();
					l.append(n), t(), e.addClass(o)
				}
			}), d.find(".selectL2R-delete").on("click", function() {
				var e = l.find(s + "." + c);
				if(0 == e.length){
					layer.msg("请先在右侧列表中选择要移除的内容");
				}else{
					e.each(function() {
						var e = $(this),
						n = e.data("id");
						e.remove(), i(n)
					})
				}
			}), d.find(".selectL2R-up").on("click", function() {
				var e = l.find(".list-group-item-warning");
				if(0 == e.length){
					layer.msg("请先在右侧列表中选择要移动的内容");
				}else if(e.length > 1){
					layer.msg("只能移动一条数据");
				}else{
	                var beforDom = e.prev("li");
	                if (beforDom.length > 0) {
	                    beforDom.before(e);
	                }
				}
			}), d.find(".selectL2R-down").on("click", function() {
				var e = l.find(".list-group-item-warning");
				if(0 == e.length){
					layer.msg("请先在右侧列表中选择要移动的内容");
				}else if(e.length > 1){
					layer.msg("只能移动一条数据");
				}else{
					var afterDom = e.next("li");
	                if (afterDom.length > 0) {
	                    afterDom.after(e);
	                }
				}
			}), d.find(".selectL2R-deleteAll").on("click", function() {
				l.find(s).remove(), a.find(s).removeClass(o)
			}), d.find(".selectL2R-selectAll").on("click", function() {
				l.find(s).remove();
				var e = a.find(s).removeClass(o).removeClass(c).addClass(o);
				l.append(e.clone().removeClass(o)), t()
			}), n && "object" == typeof n) {
			var r = n.length;
			a.find(s).each(function() {
				for(var e = $(this), i = e.data("id"), s = 0; s < r; s++)
					if(i == n[s]) {
						l.append(e.clone()), t(), e.addClass(o);
						break
					}
			})
		}
	};
	return {
		init: function(e, i) {
			n(e, i)
		},
		getResult: function(n) {
			return e(n)
		},
		getFullResult: function(n) {
			return r(n)
		}
	}
}();
(function($) {
	$.initSelectL2RFn = function(e) {
		e = $.extend({
			title: "选择",
			leftTitle: "可选择列",
			rightTitle: "已选择列",
			modalId: "#commomModal",
			fluctuation: false
		}, e);
		$(e.modalId).load("/static/data/_selectLR.html",function(ee){
			$("#_selectTitle").html(e.title);
			$("#_selectLTitle").text(e.leftTitle);
			$("#_selectRTitle").text(e.rightTitle);
			if(e.fluctuation){
				$("#selectL2RContent").find(".selectL2R-selectAll,.selectL2R-deleteAll").remove();
			}else{
				$("#selectL2RContent").find(".selectL2R-up,.selectL2R-down").remove();
			};
			$.each(e.fullData, function(k,v) {
				var isNotChoose = true;
				$.each(e.chooseData, function(m,n) {
					if(v.id == n.id){
						$("#selectRUl").append($("<li data-id=\"" + n.id + "\" class=\"list-group-item\">" + n.data + "</li>"));
                		$("#selectLUl").append($("<li data-id=\"" + n.id + "\" class=\"list-group-item list-group-item-success\">" + n.data + "</li>"));
                		isNotChoose = false;
						return true;
					}
				});
				if(isNotChoose){
					$("#selectLUl").append($("<li data-id=\"" + v.id + "\" class=\"list-group-item\">" + v.data + "</li>"));
				};
			});
			selectL2R.init('#selectL2RContent');
			$(e.modalId).modal("show");
		});
	}
})(jQuery);
(function($) {
	$.getSelectL2RData = function(d,e) {
		if(e == "fullData"){
			return selectL2R.getFullResult(d);
		}else{
			return selectL2R.getResult(d);
		}
	}
})(jQuery);