<style type="text/css">
	.fileImportModalBody .form-group {
		display: table;
	}
	
	.fileImportModalBody .form-group>label {
		width: 15%;
		min-height: 1px;
		line-height: 16px;
		padding: 0 10px 0 0;
		vertical-align: middle;
		display: table-cell;
		text-align: right;
	}
	
	.fileImportModalBody .form-group>.valiParent {
		width: 100%;
		float: left;
		position: relative;
		min-height: 1px;
		padding-left: 10px;
		padding-right: 10px;
	}
	
	.progress {
		margin-bottom: 0;
	}
	
	#scheduleDiv {
		margin: 10px 0 20px 0;
	}
</style>
<div class="modal-dialog" role="document">
	<div class="modal-content">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
			<h4 class="modal-title" id="fileUploadModalLabel"></h4>
		</div>
		<div class="modal-body fileImportModalBody">
			<form id='fileImportModalForm' action='' method='post' enctype="multipart/form-data">
				<div class="form-group col-sm-12">
					<label for="partnerCode" class="control-label">文件</label>
					<div class="valiParent">
						<input type="file" name="file" id="file" value="" accept="" />
					</div>
				</div>
				<div class="form-group col-sm-12 hidden" id="scheduleDiv">
					<label for="partnerCode" class="control-label">进度</label>
					<div class="valiParent">
						<div class="progress">
							<div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" id="schedule"></div>
						</div>
					</div>
				</div>
				<div class="form-group col-sm-12">
					<label for="partnerCode" class="control-label">导入说明</label>
					<div class="valiParent" id="fileUpliadExplain" style="color: red;">
						<i class="iconfont icon-mi required"></i>请按照下载模板中文件的格式和内容进行导入。</br>
					</div>
				</div>
			</form>
		</div>
		<div class="modal-footer">
			<button type="button" class="btn btn-default btn-circle" data-dismiss="modal"><i class="iconfont icon-close"></i> 关闭</button>
			<button type="button" class="btn btn-default btn-circle" onclick="start()"><i class="iconfont icon-close"></i> 开始</button>
			<button type="button" class="btn btn-default btn-circle" onclick="endSucess()"><i class="iconfont icon-close"></i> 成功</button>
			<button type="button" class="btn btn-default btn-circle" onclick="endError()"><i class="iconfont icon-close"></i> 失败</button>
		</div>
	</div>
</div>

<script type="text/javascript">
	function start() {
		$("#scheduleDiv").removeClass("hidden");
		$("#schedule").css("width", "5%");
		startProgerss(1000);
	}

	function endSucess() {
		//$("#progress-bar-success")
		scheduleAnimate(100);
	}

	function endError() {

	}

	//进度条的控制 
	function startProgerss() {
		var scheduleLen = 5;
		run();
		function run() {
			scheduleLen += Math.ceil((Math.random() * 10));
			$("#schedule").css("width", scheduleLen+"%");
			$("#schedule").text(scheduleLen+"%");
			if(scheduleLen < 90){
				//var timer = setTimeout(run, 100);
			}
		}
	}

	//系统全局变量获取
	var config = top.globalConfig;
	var serverPath = config.serverPath;

	function setParm(setting, successCallback) {
		var fileUploadModalLabel = setting.title == undefined ? "文件导入" : setting.title;
		$("#fileUploadModalLabel").text(fileUploadModalLabel);
		$("#commomModal").modal("show");
		var emptyFn = function() {};
		var successFn = successCallback == null || successCallback == "" ? emptyFn : successCallback;
		if(setting.accept) {
			alert(setting.accept);
		}
		//var accept = setting.uploadAsync == undefined ? true : setting.uploadAsync;
		var fileExtensions = [];

		//initFileUpload(setting.url,successFn);
	}

	/*
	 * 文件导入上传
	 */
	function initFileUpload(url, successFn) {
		$("#fileImportModalForm").ajaxSubmit({
			dataType: 'json',
			url: serverPath + url,
			resetForm: "true",
			timeout: 30000,
			beforeSend: function() {
				$('#upload').html('上传中..');
			},
			success: function(result) {
				console.log(result);
				$('#upload').html('上传成功');
			},
			error: function(xhr) {
				console.log(result)
			}
		})
	}
</script>