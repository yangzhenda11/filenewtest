function OBJ(t){this.c=null,this.type=t,this.nestedElements=[]}var ARROW_HEAD_SIMPLE="simple",ARROW_HEAD_EMPTY="empty",ARROW_HEAD_FILL="FILL",MULTILINE_VERTICAL_ALIGN_TOP="top",MULTILINE_VERTICAL_ALIGN_MIDDLE="middle",MULTILINE_VERTICAL_ALIGN_BOTTOM="bottom",MULTILINE_HORIZONTAL_ALIGN_LEFT="start",MULTILINE_HORIZONTAL_ALIGN_MIDDLE="middle",MULTILINE_HORIZONTAL_ALIGN_RIGHT="end",TEXT_PADDING=3,ARROW_WIDTH=4,CONDITIONAL_INDICATOR_WIDTH=16,MARKER_WIDTH=12,ANNOTATION_TEXT_PADDING=7,TASK_COLOR=Color.OldLace,TASK_STROKE_COLOR=Color.black,BOUNDARY_EVENT_COLOR=Color.white,CONDITIONAL_INDICATOR_COLOR=Color.get(255,255,255),HIGHLIGHT_COLOR=Color.Firebrick1,SEQUENCEFLOW_COLOR=Color.black,CATCHING_EVENT_COLOR=Color.black,START_EVENT_COLOR=Color.get(251,251,251),START_EVENT_STROKE_COLOR=Color.black,END_EVENT_COLOR=Color.get(251,251,251),NONE_END_EVENT_COLOR=Color.Firebrick4,NONE_END_EVENT_STROKE_COLOR=Color.Firebrick4,ERROR_END_EVENT_COLOR=Color.Firebrick,ERROR_END_EVENT_STROKE_COLOR=Color.Firebrick,LABEL_COLOR=Color.get(72,106,150),NORMAL_FONT={font:"10px Arial",opacity:1,fill:Color.black},LABEL_FONT={font:"11px Arial","font-style":"italic",opacity:1,fill:LABEL_COLOR},LABEL_FONT_SMOOTH={font:"10px Arial","font-style":"italic",opacity:1,fill:LABEL_COLOR,stroke:LABEL_COLOR,"stroke-width":.4},TASK_FONT={font:"11px Arial",opacity:1,fill:Color.black},TASK_FONT_SMOOTH={font:"11px Arial",opacity:1,fill:Color.black,stroke:LABEL_COLOR,"stroke-width":.4},POOL_LANE_FONT={font:"11px Arial",opacity:1,fill:Color.black},EXPANDED_SUBPROCESS_FONT={font:"11px Arial",opacity:1,fill:Color.black},NORMAL_STROKE=1,SEQUENCEFLOW_STROKE=1.5,SEQUENCEFLOW_HIGHLIGHT_STROKE=2,THICK_TASK_BORDER_STROKE=2.5,GATEWAY_TYPE_STROKE=3.2,END_EVENT_STROKE=NORMAL_STROKE+2,MULTI_INSTANCE_STROKE=1.3,EVENT_SUBPROCESS_ATTRS={stroke:Color.black,"stroke-width":NORMAL_STROKE,"stroke-dasharray":". "},EXPANDED_SUBPROCESS_ATTRS={stroke:Color.black,"stroke-width":NORMAL_STROKE,fill:Color.WhiteSmoke},NON_INTERRUPTING_EVENT_STROKE="- ",TASK_CORNER_ROUND=10,EXPANDED_SUBPROCESS_CORNER_ROUND=10,ICON_SIZE=16,ICON_PADDING=4,USERTASK_IMAGE="images/deployer/user.png",SCRIPTTASK_IMAGE="images/deployer/script.png",SERVICETASK_IMAGE="images/deployer/service.png",RECEIVETASK_IMAGE="images/deployer/receive.png",SENDTASK_IMAGE="images/deployer/send.png",MANUALTASK_IMAGE="images/deployer/manual.png",BUSINESS_RULE_TASK_IMAGE="images/deployer/business_rule.png",TIMER_IMAGE="images/deployer/timer.png",MESSAGE_CATCH_IMAGE="images/deployer/message_catch.png",MESSAGE_THROW_IMAGE="images/deployer/message_throw.png",ERROR_THROW_IMAGE="images/deployer/error_throw.png",ERROR_CATCH_IMAGE="images/deployer/error_catch.png",SIGNAL_CATCH_IMAGE="images/deployer/signal_catch.png",SIGNAL_THROW_IMAGE="images/deployer/signal_throw.png",MULTIPLE_CATCH_IMAGE="images/deployer/multiple_catch.png",ObjectType={ELLIPSE:"ellipse",FLOW:"flow",RECT:"rect",RHOMBUS:"rhombus"};OBJ.prototype={};var CONNECTION_TYPE={SEQUENCE_FLOW:"sequence_flow",MESSAGE_FLOW:"message_flow",ASSOCIATION:"association"},ProcessDiagramCanvas=function(){};ProcessDiagramCanvas.prototype={canvasHolder:"holder",canvasWidth:0,canvasHeight:0,paint:Color.black,strokeWidth:0,font:null,fontSmoothing:null,g:null,ninjaPaper:null,objects:[],processDefinitionId:null,activity:null,frame:null,debug:!1,init:function(t,e,i){this.canvasWidth=t,this.canvasHeight=e,i||(i="holder"),this.processDefinitionId=i,this.canvasHolder=this.processDefinitionId;var r=document.getElementById(this.canvasHolder);if(r){r.style.width=this.canvasWidth,r.style.height=this.canvasHeight,this.g=Raphael(this.canvasHolder),this.g.clear(),this.setPaint(Color.black),this.setStroke(NORMAL_STROKE),this.setFont(NORMAL_FONT),this.fontSmoothing=!0;var a=Raphael;this.ninjaPaper=function(t){var e=t(1,1,1,1,i);return e}(Raphael.ninja()),Raphael=a}},setPaint:function(t){this.paint=t},getPaint:function(){return this.paint},setStroke:function(t){this.strokeWidth=t},getStroke:function(){return this.strokeWidth},setFont:function(t){this.font=t},getFont:function(){return this.font},drawShaddow:function(t){var e=t.clone();return e.attr({"stroke-width":this.strokeWidth+6,stroke:Color.white,fill:Color.white,opacity:1,"stroke-dasharray":null}),t.toFront(),e},setConextObject:function(t){this.contextObject=t},getConextObject:function(){return this.contextObject},setContextToElement:function(t){var e=this.getConextObject();t.id=e.id,t.data("contextObject",e)},onClick:function(t,e,i){var r=i,a=(r.data("set"),r.data("contextObject"));if(ProcessDiagramGenerator.options&&ProcessDiagramGenerator.options.on&&ProcessDiagramGenerator.options.on.click){var s=[e,i,a];ProcessDiagramGenerator.options.on.click.apply(t,s)}},onRightClick:function(t,e,i){var r=i,a=(r.data("set"),r.data("contextObject"));if(ProcessDiagramGenerator.options&&ProcessDiagramGenerator.options.on&&ProcessDiagramGenerator.options.on.rightClick){var s=[e,i,a];ProcessDiagramGenerator.options.on.rightClick.apply(t,s)}},onHoverIn:function(t,e,i){var r=i,a=(r.data("set"),r.data("contextObject")),s=e.g.getById(a.id+"_border");if(s.attr("opacity",.3),ProcessDiagramGenerator.options&&ProcessDiagramGenerator.options.on&&ProcessDiagramGenerator.options.on.over){var n=[e,i,a];ProcessDiagramGenerator.options.on.over.apply(t,n)}},onHoverOut:function(t,e,i){var r=i,a=(r.data("set"),r.data("contextObject")),s=e.g.getById(a.id+"_border");if(s.attr("opacity",0),ProcessDiagramGenerator.options&&ProcessDiagramGenerator.options.on&&ProcessDiagramGenerator.options.on.out){var n=[e,i,a];ProcessDiagramGenerator.options.on.out.apply(t,n)}},addHandlers:function(t,e,i,r,a,s){var n=this.getConextObject(),o=e+r/2,h=i+a/2;if("event"==s)var l=this.g.ellipse(o,h,r/2+4,a/2+4),d=this.g.ellipse(o,h,r/2,a/2);else if("gateway"==s)var l=this.g.path("M"+(e-4)+" "+(i+a/2)+"L"+(e+r/2)+" "+(i+a+4)+"L"+(e+r+4)+" "+(i+a/2)+"L"+(e+r/2)+" "+(i-4)+"z"),d=this.g.path("M"+e+" "+(i+a/2)+"L"+(e+r/2)+" "+(i+a)+"L"+(e+r)+" "+(i+a/2)+"L"+(e+r/2)+" "+i+"z");else if("task"==s)var l=this.g.rect(e-4,i-4,r+9,a+9,TASK_CORNER_ROUND+4),d=this.g.rect(e,i,r,a,TASK_CORNER_ROUND);l.attr({stroke:Color.get(132,112,255),"stroke-width":4,opacity:0}),l.id=n.id+"_border",t.push(l),d.attr({stroke:Color.Orange,"stroke-width":3,fill:Color.get(0,0,0),opacity:0,cursor:"hand"}),d.data("set",t),d.id=n.id,d.data("contextObject",n);var g=this;d.mousedown(function(t){2==t.button&&g.onRightClick(t,g,this)}),d.click(function(t){g.onClick(t,g,this)}),d.hover(function(t){g.onHoverIn(t,g,this)},function(t){g.onHoverOut(t,g,this)})},drawNoneStartEvent:function(t,e,i,r){this.g.setStart();var a=void 0;this._drawStartEvent(t,e,i,r,a,null);var s=this.g.setFinish();this.addHandlers(s,t,e,i,r,"event")},drawTimerStartEvent:function(t,e,i,r,a){this.g.setStart(),this._drawStartEvent(t,e,i,r,a,null);var s=t+i/2-this.getStroke()/4,n=e+r/2-this.getStroke()/4,o=.9*i,h=.9*r;if(this._drawClock(s,n,o,h),this.gebug){this.g.ellipse(s,n,3,3).attr({stroke:"none",fill:Color.green})}var l=this.g.setFinish();this.addHandlers(l,t,e,i,r,"event")},drawMessageStartEvent:function(t,e,i,r,a){this.g.setStart(),this._drawStartEvent(t,e,i,r,a,null),this._drawStartEventImage(t,e,i,r,MESSAGE_CATCH_IMAGE);var s=this.g.setFinish();this.addHandlers(s,t,e,i,r,"event")},drawErrorStartEvent:function(t,e,i,r){this.g.setStart();var a=void 0;this._drawStartEvent(t,e,i,r,a),this._drawStartEventImage(t,e,i,r,ERROR_CATCH_IMAGE);var s=this.g.setFinish();this.addHandlers(s,t,e,i,r,"event")},drawSignalStartEvent:function(t,e,i,r,a){this.g.setStart(),this._drawStartEvent(t,e,i,r,a,null),this._drawStartEventImage(t,e,i,r,SIGNAL_CATCH_IMAGE);var s=this.g.setFinish();this.addHandlers(s,t,e,i,r,"event")},drawMultipleStartEvent:function(t,e,i,r,a){this.g.setStart(),this._drawStartEvent(t,e,i,r,a,null);var s=t+i/2-this.getStroke()/4,n=e+r/2-this.getStroke()/4,o=1*i,h=1*r;this._drawPentagon(s,n,o,h);var l=this.g.setFinish();this.addHandlers(l,t,e,i,r,"event")},_drawStartEventImage:function(t,e,i,r,a){{var s=t+i/2-this.getStroke()/2,n=e+r/2-this.getStroke()/2,o=.65*i,h=.65*r;this.g.image(a,s-o/2,n-h/2,o,h)}},_drawStartEvent:function(t,e,i,r,a){var s=this.getPaint();"undefined"!=typeof START_EVENT_STROKE_COLOR&&this.setPaint(START_EVENT_STROKE_COLOR),i-=this.strokeWidth/2,r-=this.strokeWidth/2,t+=i/2,e+=r/2;var n=this.g.ellipse(t,e,i/2,r/2);n.attr({"stroke-width":this.strokeWidth,stroke:this.paint,fill:START_EVENT_COLOR}),this.drawShaddow(n),null==a||void 0==a||a||n.attr({"stroke-dasharray":NON_INTERRUPTING_EVENT_STROKE}),this.setContextToElement(n),this.setPaint(s)},drawNoneEndEvent:function(t,e,i,r){this.g.setStart(),this._drawNoneEndEvent(t,e,i,r,null,"noneEndEvent");var a=this.g.setFinish();this.addHandlers(a,t,e,i,r,"event")},drawErrorEndEvent:function(t,e,i,r){this.g.setStart();var a="errorEndEvent";this._drawNoneEndEvent(t,e,i,r,null,a),this._drawEndEventImage(t,e,i,r,ERROR_THROW_IMAGE);var s=this.g.setFinish();this.addHandlers(s,t,e,i,r,"event")},drawMessageEndEvent:function(t,e,i,r){this.g.setStart();var a="errorEndEvent";this._drawNoneEndEvent(t,e,i,r,null,a),this._drawEndEventImage(t,e,i,r,MESSAGE_THROW_IMAGE);var s=this.g.setFinish();this.addHandlers(s,t,e,i,r,"event")},drawSignalEndEvent:function(t,e,i,r){this.g.setStart();var a="errorEndEvent";this._drawNoneEndEvent(t,e,i,r,null,a),this._drawEndEventImage(t,e,i,r,SIGNAL_THROW_IMAGE);var s=this.g.setFinish();this.addHandlers(s,t,e,i,r,"event")},drawMultipleEndEvent:function(t,e,i,r){this.g.setStart();var a="errorEndEvent";this._drawNoneEndEvent(t,e,i,r,null,a);var s=t+i/2,n=e+r/2,o=1*i,h=1*r,l=!0;this._drawPentagon(s,n,o,h,l);var d=this.g.setFinish();this.addHandlers(d,t,e,i,r,"event")},drawTerminateEndEvent:function(t,e,i,r){this.g.setStart();var a="errorEndEvent";this._drawNoneEndEvent(t,e,i,r,null,a);var s=t+i/2,n=e+r/2,o=i/2*.6,h=r/2*.6,l=(this.g.ellipse(s,n,o,h).attr({fill:Color.black}),this.g.setFinish());this.addHandlers(l,t,e,i,r,"event")},_drawEndEventImage:function(t,e,i,r,a){{var s=t+i/2-this.getStroke()/2,n=e+r/2-this.getStroke()/2,o=.65*i,h=.65*r;this.g.image(a,s-o/2,n-h/2,o,h)}},_drawNoneEndEvent:function(t,e,i,r,a,s){var n=this.getPaint();"undefined"!=typeof CATCHING_EVENT_COLOR&&this.setPaint(CATCHING_EVENT_COLOR);var o=this.getPaint(),h=this.getPaint();"errorEndEvent"==s?(o=ERROR_END_EVENT_STROKE_COLOR,h=ERROR_END_EVENT_COLOR):"noneEndEvent"==s?(o=NONE_END_EVENT_STROKE_COLOR,h=NONE_END_EVENT_COLOR):i-=this.strokeWidth/2,r-=this.strokeWidth/2,t+=i/2,e+=i/2;{var l=this.g.ellipse(t,e,i/2,r/2);this.drawShaddow(l)}l.attr({"stroke-width":this.strokeWidth,stroke:o,fill:h});var d=t,g=e,E=i/2-2,_=r/2-2,c=this.g.ellipse(d,g,E,_);c.attr({"stroke-width":this.strokeWidth,stroke:o,fill:Color.white}),this.setPaint(n)},drawCatchingTimerEvent:function(t,e,i,r,a){this.g.setStart(),this._drawCatchingEvent(t,e,i,r,a,null);var s=i-4,n=r-4,o=t+i/2-this.getStroke()/4,h=e+r/2-this.getStroke()/4,l=.9*s,d=.9*n;this._drawClock(o,h,l,d);var g=this.g.setFinish();this.addHandlers(g,t,e,i,r,"event")},drawCatchingErrorEvent:function(t,e,i,r,a){this.g.setStart(),this._drawCatchingEvent(t,e,i,r,a,null),this._drawCatchingEventImage(t,e,i,r,ERROR_CATCH_IMAGE);var s=this.g.setFinish();this.addHandlers(s,t,e,i,r,"event")},drawCatchingSignalEvent:function(t,e,i,r,a){this.g.setStart(),this._drawCatchingEvent(t,e,i,r,a,null),this._drawCatchingEventImage(t,e,i,r,SIGNAL_CATCH_IMAGE);var s=this.g.setFinish();this.addHandlers(s,t,e,i,r,"event")},drawCatchingMessageEvent:function(t,e,i,r,a){this.g.setStart(),this._drawCatchingEvent(t,e,i,r,a,null),this._drawCatchingEventImage(t,e,i,r,MESSAGE_CATCH_IMAGE);var s=this.g.setFinish();this.addHandlers(s,t,e,i,r,"event")},drawCatchingMultipleEvent:function(t,e,i,r,a){this.g.setStart(),this._drawCatchingEvent(t,e,i,r,a,null);var s=t+i/2-this.getStroke(),n=e+r/2-this.getStroke(),o=.9*i,h=.9*r;this._drawPentagon(s,n,o,h);var l=this.g.setFinish();this.addHandlers(l,t,e,i,r,"event")},_drawCatchingEventImage:function(t,e,i,r,a){{var s=i-4,n=r-4,o=t+i/2-this.getStroke()/2,h=e+r/2-this.getStroke()/2,l=.6*s,d=.6*n;this.g.image(a,o-l/2,h-d/2,l,d)}},_drawCatchingEvent:function(t,e,i,r,a,s){var n=this.getPaint();"undefined"!=typeof CATCHING_EVENT_COLOR&&this.setPaint(CATCHING_EVENT_COLOR),i-=this.strokeWidth/2,r-=this.strokeWidth/2,t+=i/2,e+=i/2;var o=this.g.ellipse(t,e,i/2,r/2),h=this.drawShaddow(o);null==a||void 0==a||a||o.attr({"stroke-dasharray":NON_INTERRUPTING_EVENT_STROKE}),o.attr({"stroke-width":this.strokeWidth,stroke:this.getPaint(),fill:BOUNDARY_EVENT_COLOR});var l=t,d=e,g=i/2-4,E=r/2-4,_=this.g.ellipse(l,d,g,E);if(_.attr({"stroke-width":this.strokeWidth,stroke:this.getPaint()}),s){var c=imageHeight=1.2*g+2*this.getStroke(),T=l-c/2-this.strokeWidth/2,O=d-c/2-this.strokeWidth/2;this.g.image(s,T,O,c,imageHeight)}this.setPaint(n);var I=this.g.set();I.push(o,_,h),this.setContextToElement(o)},drawThrowingNoneEvent:function(t,e,i,r){this.g.setStart(),this._drawCatchingEvent(t,e,i,r,null,null);var a=this.g.setFinish();this.addHandlers(a,t,e,i,r,"event")},drawThrowingSignalEvent:function(t,e,i,r){this.g.setStart(),this._drawCatchingEvent(t,e,i,r,null,null),this._drawCatchingEventImage(t,e,i,r,SIGNAL_THROW_IMAGE);var a=this.g.setFinish();this.addHandlers(a,t,e,i,r,"event")},drawThrowingMessageEvent:function(t,e,i,r){this.g.setStart(),this._drawCatchingEvent(t,e,i,r,null,null),this._drawCatchingEventImage(t,e,i,r,MESSAGE_THROW_IMAGE);var a=this.g.setFinish();this.addHandlers(a,t,e,i,r,"event")},drawThrowingMultipleEvent:function(t,e,i,r){this.g.setStart(),this._drawCatchingEvent(t,e,i,r,null,null);var a=t+i/2-this.getStroke(),s=e+r/2-this.getStroke(),n=.9*i,o=.9*r,h=!0;this._drawPentagon(a,s,n,o,h);var l=this.g.setFinish();this.addHandlers(l,t,e,i,r,"event")},_connectFlowToActivity:function(t,e,i){var r=this.g.getById(t),a=this.g.getById(e);if(null==r||null==a)return console.error(null==r?"source activity["+t+"] not found":"destination activity["+e+"] not found"),null;for(var s=(r.getBBox(),a.getBBox(),[]),n=[],o=0;o<i.length;o++){var h="";h=0==o?"M":"L",s.push([h,i[o].x,i[o].y]),n.push({x:i[o].x,y:i[o].y})}var l=this.ninjaPaper.path(r.realPath),d=this.ninjaPaper.path(a.realPath),g=l.getBBox(),E=d.getBBox(),_=s,c={x:_[0][1],y:_[0][2]},T={x:_[_.length-1][1],y:_[_.length-1][2]};_[0][1]=g.x+(g.x2-g.x)/2,_[0][2]=g.y+(g.y2-g.y)/2,_[_.length-1][1]=E.x+(E.x2-E.x)/2,_[_.length-1][2]=E.y+(E.y2-E.y)/2;var O=this.ninjaPaper.path(_),I=(O.getBBox(),Raphael.pathIntersection(l.realPath,O.realPath)),S=Raphael.pathIntersection(d.realPath,O.realPath),C=I.pop(),v=S.pop();if(void 0!=C){if(this.gebug){var u=5;this.g.ellipse(c.x,c.y,u,u).attr({fill:Color.white,stroke:Color.Pink}),this.g.ellipse(C.x,C.y,u,u).attr({fill:Color.white,stroke:Color.Green})}n[0].x=C.x,n[0].y=C.y}if(void 0!=v){if(this.gebug){var u=5;this.g.ellipse(T.x,T.y,u,u).attr({fill:Color.white,stroke:Color.Red}),this.g.ellipse(v.x,v.y,u,u).attr({fill:Color.white,stroke:Color.Blue})}n[n.length-1].x=v.x,n[n.length-1].y=v.y}return this.ninjaPaper.clear(),n},_drawFlow:function(t,e,i,r,a,s){var n=this.getPaint(),o=this.getStroke();this.setPaint(SEQUENCEFLOW_COLOR),this.setStroke(SEQUENCEFLOW_STROKE),r&&(this.setPaint(HIGHLIGHT_COLOR),this.setStroke(SEQUENCEFLOW_HIGHLIGHT_STROKE));var h=Raphael.createUUID(),l=this.getConextObject(),d=t;if(l){var d=this._connectFlowToActivity(l.sourceActivityId,l.destinationActivityId,t);if(!d)return void console.error("Error draw flow from '"+l.sourceActivityId+"' to '"+l.destinationActivityId+"' ")}var g=new Polyline(h,d,this.getStroke());g.element=this.g.path(g.path),g.element.attr("stroke-width",this.getStroke()),g.element.attr("stroke",this.getPaint()),l?(g.element.id=l.id,g.element.data("contextObject",l)):g.element.id=h;var E=g.getAnchorsCount()-1,_=(g.getAnchor(E).x,g.getAnchor(E).y,g.getLinesCount()-1),c=g.getLine(_),T=g.getLine(0),O=null,I=null,S=null,C=null;s==CONNECTION_TYPE.MESSAGE_FLOW&&(I=this._drawCircleTail(T,s)),a&&(O=this._drawArrowHead(c,s)),i&&g.isDefaultConditionAvailable&&(S=this._drawDefaultSequenceFlowIndicator(T)),e&&(C=this._drawConditionalSequenceFlowIndicator(T));var v=l.name;if(v){var u=l.xPointArray,N=l.yPointArray,w=u[0]<u[1]?u[0]:u[1],A=N[0]<N[1]?N[1]:N[0];w+=20,A-=10,this.g.text(w,A,v).attr(LABEL_FONT)}var R=this.g.set();R.push(g.element,O,I,C),g.element.data("set",R),g.element.data("withArrowHead",a);var f={"stroke-width":this.getStroke()+5,stroke:Color.get(132,112,255),opacity:0,cursor:"hand"},k=R.clone().attr(f).hover(function(){k.attr({opacity:.2})},function(){k.attr({opacity:0})});k.data("objectId",g.element.id),k.click(function(){var t=this,e=t.data("objectId"),i=this.paper.getById(e),r=i.data("contextObject");r&&(console.log("[flow], objectId: "+i.id+", flow: "+r.flow),ProcessDiagramGenerator.showFlowInfo(r))}).dblclick(function(){console.log("!!! DOUBLE CLICK !!!")}).hover(function(){var t=this,e=t.data("objectId"),i=this.paper.getById(e),r=i.data("contextObject");r&&ProcessDiagramGenerator.showFlowInfo(r)}),k.data("parentId",h),s&&s!=CONNECTION_TYPE.SEQUENCE_FLOW?s==CONNECTION_TYPE.MESSAGE_FLOW?g.element.attr({"stroke-dasharray":"--"}):s==CONNECTION_TYPE.ASSOCIATION&&g.element.attr({"stroke-dasharray":". "}):g.element.attr("stroke-width",this.getStroke()),this.setPaint(n),this.setStroke(o)},_drawDefaultSequenceFlowIndicator:function(t){var e=10;c=e/2,f=8;var i=this.g.path("M"+-c+" 0L"+c+" 0");i.attr("stroke-width",this.getStroke()+0),i.attr("stroke",this.getPaint());var r=Math.cos(t.angle),a=Math.sin(t.angle),s=f*r,n=f*a,o=t.x1+s+0*c*r,h=t.y1+n+0*c*a;return i.transform("t"+o+","+h),i.transform("...r"+Raphael.deg(t.angle-3*Math.PI/4)+" 0 0"),i},drawSequenceflow:function(t,e,i,r){var a=!0;this._drawFlow(t,e,i,r,a,CONNECTION_TYPE.SEQUENCE_FLOW)},drawMessageflow:function(t,e){var i=!0,r=isDefault=!1;this._drawFlow(t,r,isDefault,e,i,CONNECTION_TYPE.MESSAGE_FLOW)},drawAssociation:function(t,e,i){var e=e,r=isDefault=!1;this._drawFlow(t,r,isDefault,i,e,CONNECTION_TYPE.ASSOCIATION)},_drawCircleTail:function(t){var e=ARROW_WIDTH/2*1.5;this.strokeWidth%2==1&&(t.x1+=.5,t.y1+=.5);var i=this.g.ellipse(t.x1,t.y1,e,e);return i.attr("fill",Color.white),i.attr("stroke",this.getPaint()),i},_drawArrowHead:function(t,e){var i=2*ARROW_WIDTH;if(e==CONNECTION_TYPE.ASSOCIATION)var r=this.g.path("M-"+(ARROW_WIDTH/2+.5)+" -"+i+"L 0 0 L"+(ARROW_WIDTH/2+.5)+" -"+i);else var r=this.g.path("M0 0L-"+(ARROW_WIDTH/2+.5)+" -"+i+"L"+(ARROW_WIDTH/2+.5)+" -"+i+"z");return this.strokeWidth%2==1&&(t.x2+=.5,t.y2+=.5),r.transform("t"+t.x2+","+t.y2),r.transform("...r"+Raphael.deg(t.angle-Math.PI/2)+" 0 0"),e&&e!=CONNECTION_TYPE.SEQUENCE_FLOW?e==CONNECTION_TYPE.MESSAGE_FLOW&&r.attr("fill",Color.white):r.attr("fill",this.getPaint()),r.attr("stroke-width",this.getStroke()),r.attr("stroke",this.getPaint()),r},_drawConditionalSequenceFlowIndicator:function(t){var e=.7*CONDITIONAL_INDICATOR_WIDTH,i=e/2,r=CONDITIONAL_INDICATOR_WIDTH/2,a=[{x:0,y:0},{x:-i,y:r},{x:0,y:CONDITIONAL_INDICATOR_WIDTH},{x:i,y:r}],s=new Polygone(a,this.getStroke());s.element=this.g.path(s.path),s.element.attr("fill",Color.white),s.transform("t"+t.x1+","+t.y1),s.transform("...r"+Raphael.deg(t.angle-Math.PI/2)+" 0 0");Math.cos(t.angle),Math.sin(t.angle);return s.attr({"stroke-width":this.getStroke(),stroke:this.getPaint()}),s.element},drawSequenceflowWithoutArrow:function(t,e,i,r){var a=!1;this._drawFlow(t,e,i,r,a,CONNECTION_TYPE.SEQUENCE_FLOW)},drawPoolOrLane:function(t,e,i,r,a){this.strokeWidth%2==1&&(t=Math.round(t)+.5,e=Math.round(e)+.5);var s=this.g.rect(t,e,i,r),n={"stroke-width":NORMAL_STROKE,stroke:TASK_STROKE_COLOR};if(s.attr(n),null!=a&&a.length>0){var n=POOL_LANE_FONT,o=r-6,h=this.fitTextToWidth(a,o),l=this.getStringWidth(h,n),d=this.getStringHeight(h,n),g=t+2+1*d-d/2,E=3+e+o-(o-l)/2-l/2,_=this.g.text(g,E,h).attr(n);_.transform("r"+Raphael.deg(270*Math.PI/180)+" "+g+" "+E)}},_drawTask:function(t,e,i,r,a,s){var n=this.getPaint();this.setPaint(TASK_COLOR),this.strokeWidth%2==1&&(e=Math.round(e)+.5,i=Math.round(i)+.5);var o=this.g.rect(e,i,r,a,TASK_CORNER_ROUND),h={"stroke-width":this.strokeWidth,stroke:TASK_STROKE_COLOR,fill:this.getPaint()};o.attr(h);var l=this.getConextObject();if(l&&(o.id=l.id,o.data("contextObject",l)),this.setPaint(n),this.drawShaddow(o),s&&o.attr({"stroke-width":THICK_TASK_BORDER_STROKE}),t){var d=r-2*TEXT_PADDING,g=a-ICON_SIZE-ICON_PADDING-ICON_PADDING-MARKER_WIDTH-2-2,E=e+r/2-d/2,_=i+a/2-g/2+ICON_PADDING+ICON_PADDING-2-2;this.drawTaskLabel(t,E,_,d,g)}},drawTaskLabel:function(t,e,i,r,a){var s=this.getFont();this.setFont(TASK_FONT),this._drawMultilineText(t,e,i,r,a,MULTILINE_VERTICAL_ALIGN_MIDDLE,MULTILINE_HORIZONTAL_ALIGN_MIDDLE),this.setFont(s)},drawAnnotationText:function(t,e,i,r,a){var s=this.getPaint(),n=this.getFont();this.setPaint(Color.black),this.setFont(TASK_FONT),this._drawMultilineText(t,e,i,r,a,MULTILINE_VERTICAL_ALIGN_TOP,MULTILINE_HORIZONTAL_ALIGN_LEFT),this.setPaint(s),this.setFont(n)},drawLabel:function(t,e,i,r,a){var s=this.getPaint(),n=this.getFont();this.setPaint(LABEL_COLOR),this.setFont(LABEL_FONT_SMOOTH),r&&a||(r=100,a=0),e-=r/2,this._drawMultilineText(t,e,i,r,a,MULTILINE_VERTICAL_ALIGN_TOP,MULTILINE_HORIZONTAL_ALIGN_MIDDLE),this.setPaint(s),this.setFont(n)},getStringWidth:function(t,e){{var i=this.g.text(0,0,t).attr(e).hide();i.getBBox()}return i.getBBox().width},getStringHeight:function(t,e){{var i=this.g.text(0,0,t).attr(e).hide();i.getBBox()}return i.getBBox().height},fitTextToWidth:function(t,e){for(var i=t,r={font:"11px Arial",opacity:0},a=this.g.text(0,0,"...").attr(r).hide(),s=a.getBBox(),n=e-s.width,o=this.g.text(0,0,i).attr(r).hide(),h=o.getBBox();h.width>n&&i.length>0;)i=i.substring(0,i.length-1),o.attr({text:i}),h=o.getBBox();return o.remove(),i!=t&&(i+="..."),i},wrapTextToWidth:function(t,e){for(var i=t,r="\n",a={font:"11px Arial",opacity:0},s=this.g.text(0,0,r).attr(a).hide(),n=s.getBBox(),o="",h=0,l=0;i.length>0;){for(;n.width<e&&i.length>0&&(r=r.substring(0,r.length-1),r=r+i.substring(0,1)+"\n",i=i.substring(1),s.attr({text:r}),n=s.getBBox(),h++,!(h>200)););if(r=r.substring(0,r.length-1),0==i.length){o+=r;break}if(i=r.substring(r.length-1)+i,r=r.substring(0,r.length-1)+"\n",s.attr({text:r}),n=s.getBBox(),o+=r,r="\n",l++,l>20)break}return s.remove(),o},wrapTextToWidth2:function(t,e){for(var i=t,r="\n",a={font:"11px Arial",opacity:0},s=this.g.text(0,0,r).attr(a).hide(),n=s.getBBox(),o="",h=0,l=0;i.length>0;){for(;n.width<e&&i.length>0&&(r=r.substring(0,r.length-1),r=r+i.substring(0,1)+"\n",i=i.substring(1),s.attr({text:r}),n=s.getBBox(),h++,!(h>200)););if(r=r.substring(0,r.length-1),0==i.length){o+=r;break}if(i=r.substring(r.length-1)+i,r=r.substring(0,r.length-1)+"\n",s.attr({text:r}),n=s.getBBox(),o+=r,r="\n",l++,l>20)break}return s.remove(),o},drawUserTask:function(t,e,i,r,a){this.g.setStart(),this._drawTask(t,e,i,r,a);var s=(this.g.image(USERTASK_IMAGE,e+ICON_PADDING,i+ICON_PADDING,ICON_SIZE,ICON_SIZE),this.g.setFinish());this.addHandlers(s,e,i,r,a,"task")},drawScriptTask:function(t,e,i,r,a){this.g.setStart(),this._drawTask(t,e,i,r,a);var s=(this.g.image(SCRIPTTASK_IMAGE,e+ICON_PADDING,i+ICON_PADDING,ICON_SIZE,ICON_SIZE),this.g.setFinish());this.addHandlers(s,e,i,r,a,"task")},drawServiceTask:function(t,e,i,r,a){this.g.setStart(),this._drawTask(t,e,i,r,a);var s=(this.g.image(SERVICETASK_IMAGE,e+ICON_PADDING,i+ICON_PADDING,ICON_SIZE,ICON_SIZE),this.g.setFinish());this.addHandlers(s,e,i,r,a,"task")},drawReceiveTask:function(t,e,i,r,a){this.g.setStart(),this._drawTask(t,e,i,r,a);var s=(this.g.image(RECEIVETASK_IMAGE,e+7,i+7,ICON_SIZE,ICON_SIZE),this.g.setFinish());this.addHandlers(s,e,i,r,a,"task")},drawSendTask:function(t,e,i,r,a){this.g.setStart(),this._drawTask(t,e,i,r,a);var s=(this.g.image(SENDTASK_IMAGE,e+7,i+7,ICON_SIZE,ICON_SIZE),this.g.setFinish());this.addHandlers(s,e,i,r,a,"task")},drawManualTask:function(t,e,i,r,a){this.g.setStart(),this._drawTask(t,e,i,r,a);var s=(this.g.image(MANUALTASK_IMAGE,e+7,i+7,ICON_SIZE,ICON_SIZE),this.g.setFinish());this.addHandlers(s,e,i,r,a,"task")},drawBusinessRuleTask:function(t,e,i,r,a){this.g.setStart(),this._drawTask(t,e,i,r,a);var s=(this.g.image(BUSINESS_RULE_TASK_IMAGE,e+7,i+7,ICON_SIZE,ICON_SIZE),this.g.setFinish());this.addHandlers(s,e,i,r,a,"task")},drawExpandedSubProcess:function(t,e,i,r,a,s){this.g.setStart(),this.strokeWidth%2==1&&(e=Math.round(e)+.5,i=Math.round(i)+.5);var n=this.g.rect(e,i,r,a,EXPANDED_SUBPROCESS_CORNER_ROUND);n.attr(s?EVENT_SUBPROCESS_ATTRS:EXPANDED_SUBPROCESS_ATTRS),this.setContextToElement(n);{var o=EXPANDED_SUBPROCESS_FONT,h=10,l=5,d=r-2*h,g=this.fitTextToWidth(t,d),E=this.getStringWidth(g,o),_=this.getStringHeight(g,o);this.g.text(e+r/2-0*E/2+0*h,i+_/2+l,g).attr(o),this.g.setFinish()}},drawCollapsedSubProcess:function(t,e,i,r,a){this.g.setStart(),this._drawCollapsedTask(t,e,i,r,a,!1);var s=this.g.setFinish();this.addHandlers(s,e,i,r,a,"task")},drawCollapsedCallActivity:function(t,e,i,r,a){this.g.setStart(),this._drawCollapsedTask(t,e,i,r,a,!0);var s=this.g.setFinish();this.addHandlers(s,e,i,r,a,"task")},_drawCollapsedTask:function(t,e,i,r,a,s){this._drawTask(t,e,i,r,a,s)},drawCollapsedMarker:function(t,e,i,r){var a=MARKER_WIDTH,s=MARKER_WIDTH;this.strokeWidth%2==1&&(e+=.5);{var n=this.g.rect(t+(i-a)/2,e+r-s-3,a,s),o=n.attr("x")+n.attr("width")/2,h=n.attr("y")+n.attr("height")/2;this.g.path("M"+o+" "+(h+2)+"L"+o+" "+(h-2)+"M"+(o-2)+" "+h+"L"+(o+2)+" "+h).attr({"stroke-width":this.strokeWidth})}},drawActivityMarkers:function(t,e,i,r,a,s,n){n?a||s?(this.drawCollapsedMarker(t-MARKER_WIDTH/2-2,e,i,r),a?(console.log("is collapsed and multiInstanceSequential"),this.drawMultiInstanceMarker(!0,t+MARKER_WIDTH/2+2,e,i,r)):s&&(console.log("is collapsed and multiInstanceParallel"),this.drawMultiInstanceMarker(!1,t+MARKER_WIDTH/2+2,e,i,r))):this.drawCollapsedMarker(t,e,i,r):a?(console.log("is multiInstanceSequential"),this.drawMultiInstanceMarker(!0,t,e,i,r)):s&&(console.log("is multiInstanceParallel"),this.drawMultiInstanceMarker(!1,t,e,i,r))},drawGateway:function(t,e,i,r){var a=this.g.path("M"+t+" "+(e+r/2)+"L"+(t+i/2)+" "+(e+r)+"L"+(t+i)+" "+(e+r/2)+"L"+(t+i/2)+" "+e+"z");return this.drawShaddow(a),a.attr("stroke-width",this.strokeWidth),a.attr("stroke",Color.SlateGrey),a.attr({fill:Color.white}),this.setContextToElement(a),a},drawParallelGateway:function(t,e,i,r){this.g.setStart(),this.drawGateway(t,e,i,r);var a=this.getStroke();this.setStroke(GATEWAY_TYPE_STROKE);var s=this.g.path("M"+(t+10)+" "+(e+r/2)+"L"+(t+i-10)+" "+(e+r/2)+"M"+(t+i/2)+" "+(e+r-10)+"L"+(t+i/2)+" "+(e+10));s.attr({"stroke-width":this.getStroke(),stroke:this.getPaint()}),this.setStroke(a);var n=this.g.setFinish();this.addHandlers(n,t,e,i,r,"gateway")},drawExclusiveGateway:function(t,e,i,r){this.g.setStart();var a=(this.drawGateway(t,e,i,r),i/4),s=r/4,n=this.getStroke();this.setStroke(GATEWAY_TYPE_STROKE);var o=this.g.path("M"+(t+a+3)+" "+(e+s+3)+"L"+(t+3*a-3)+" "+(e+3*s-3)+"M"+(t+a+3)+" "+(e+3*s-3)+"L"+(t+3*a-3)+" "+(e+s+3));o.attr({"stroke-width":this.getStroke(),stroke:this.getPaint()}),this.setStroke(n);var h=this.g.setFinish();this.addHandlers(h,t,e,i,r,"gateway")},drawInclusiveGateway:function(t,e,i,r){this.g.setStart(),this.drawGateway(t,e,i,r);var a=i/4,s=this.getStroke();this.setStroke(GATEWAY_TYPE_STROKE);var n=this.g.ellipse(i/2+t,r/2+e,a,a);n.attr({"stroke-width":this.getStroke(),stroke:this.getPaint()}),this.setStroke(s);var o=this.g.setFinish();this.addHandlers(o,t,e,i,r,"gateway")},drawEventBasedGateway:function(t,e,i,r){this.g.setStart(),this.drawGateway(t,e,i,r);var a=this.getStroke();this.setStroke(GATEWAY_TYPE_STROKE);for(var s=5,n=2*Math.PI/s,o=[],h=[],l=0;s>l;l++){var d=l*n-Math.PI/2;o[l]=t+parseInt(Math.round(i/2))+parseInt(Math.round(i/4*Math.cos(d))),h[l]=e+parseInt(Math.round(r/2))+parseInt(Math.round(r/4*Math.sin(d)))}for(var g="",l=0;s>l;l++)g+=0==l?"M":"L",g+=o[l]+","+h[l];g+="z";var E=this.g.path(g);E.attr("stroke-width",this.strokeWidth),E.attr("stroke",this.getPaint()),this.setStroke(a);var _=this.g.setFinish();this.addHandlers(_,t,e,i,r,"gateway")},drawMultiInstanceMarker:function(t,e,i,r,a){var s=MARKER_WIDTH,n=MARKER_WIDTH;this.strokeWidth%2==1&&(e+=.5);var o=e+(r-s)/2,h=i+a-n-3,l=this.getStroke();if(this.setStroke(MULTI_INSTANCE_STROKE),t){this.g.path("M"+o+" "+h+"L"+(o+s)+" "+h+"M"+o+" "+(h+n/2)+"L"+(o+s)+" "+(h+n/2)+"M"+o+" "+(h+n)+"L"+(o+s)+" "+(h+n)).attr({"stroke-width":this.strokeWidth})}else{this.g.path("M"+o+" "+h+"L"+o+" "+(h+n)+"M"+(o+s/2)+" "+h+"L"+(o+s/2)+" "+(h+n)+"M"+(o+s)+" "+h+"L"+(o+s)+" "+(h+n)).attr({"stroke-width":this.strokeWidth})}this.setStroke(l)},drawHighLight:function(t,e,i,r){var a=this.getPaint(),s=this.getStroke();this.setPaint(HIGHLIGHT_COLOR),this.setStroke(THICK_TASK_BORDER_STROKE);var n=this.g.rect(t-THICK_TASK_BORDER_STROKE,e-THICK_TASK_BORDER_STROKE,i+2*THICK_TASK_BORDER_STROKE,r+2*THICK_TASK_BORDER_STROKE,TASK_CORNER_ROUND);n.attr("stroke-width",this.strokeWidth),n.attr("stroke",this.getPaint()),this.setPaint(a),this.setStroke(s)},highLightActivity:function(t){var e=this.g.getById(t);if(!e)return void console.error("Activity "+t+" not found");var i=e.data("contextObject");i?console.log("--> highLightActivity: ["+i.getProperty("type")+"], activityId: "+i.getId()):console.log("--> highLightActivity: ",e,e.data("contextObject")),e.attr("stroke-width",THICK_TASK_BORDER_STROKE),e.attr("stroke",HIGHLIGHT_COLOR)},highLightFlow:function(t){var e=this.g.getById(t);if(!e)return void console.error("Flow "+t+" not found");var i=e.data("contextObject");i&&console.log("--> highLightFlow: ["+i.id+"] "+i.flow);var r=e.data("set");r.attr("stroke-width",SEQUENCEFLOW_HIGHLIGHT_STROKE),r.attr("stroke",HIGHLIGHT_COLOR);var a=e.data("withArrowHead");a&&r[1].attr("fill",HIGHLIGHT_COLOR),r.forEach(function(){})},_drawClock:function(t,e,i,r){var a=this.g.ellipse(t,e,1,1).attr({stroke:"none",fill:Color.get(232,239,241)}),s=this.g.path("M15.5,2.374		C8.251,2.375,2.376,8.251,2.374,15.5		C2.376,22.748,8.251,28.623,15.5,28.627c7.249-0.004,13.124-5.879,13.125-13.127C28.624,8.251,22.749,2.375,15.5,2.374zM15.5,26.623	C8.909,26.615,4.385,22.09,4.375,15.5	C4.385,8.909,8.909,4.384,15.5,4.374c4.59,0.01,11.115,3.535,11.124,11.125C26.615,22.09,22.091,26.615,15.5,26.623zM8.625,15.5c-0.001-0.552-0.448-0.999-1.001-1c-0.553,0-1,0.448-1,1c0,0.553,0.449,1,1,1C8.176,16.5,8.624,16.053,8.625,15.5zM8.179,18.572c-0.478,0.277-0.642,0.889-0.365,1.367c0.275,0.479,0.889,0.641,1.365,0.365c0.479-0.275,0.643-0.887,0.367-1.367C9.27,18.461,8.658,18.297,8.179,18.572zM9.18,10.696c-0.479-0.276-1.09-0.112-1.366,0.366s-0.111,1.09,0.365,1.366c0.479,0.276,1.09,0.113,1.367-0.366C9.821,11.584,9.657,10.973,9.18,10.696zM22.822,12.428c0.478-0.275,0.643-0.888,0.366-1.366c-0.275-0.478-0.89-0.642-1.366-0.366c-0.479,0.278-0.642,0.89-0.366,1.367C21.732,12.54,22.344,12.705,22.822,12.428zM12.062,21.455c-0.478-0.275-1.089-0.111-1.366,0.367c-0.275,0.479-0.111,1.09,0.366,1.365c0.478,0.277,1.091,0.111,1.365-0.365C12.704,22.344,12.54,21.732,12.062,21.455zM12.062,9.545c0.479-0.276,0.642-0.888,0.366-1.366c-0.276-0.478-0.888-0.642-1.366-0.366s-0.642,0.888-0.366,1.366C10.973,9.658,11.584,9.822,12.062,9.545zM22.823,18.572c-0.48-0.275-1.092-0.111-1.367,0.365c-0.275,0.479-0.112,1.092,0.367,1.367c0.477,0.275,1.089,0.113,1.365-0.365C23.464,19.461,23.3,18.848,22.823,18.572zM19.938,7.813c-0.477-0.276-1.091-0.111-1.365,0.366c-0.275,0.48-0.111,1.091,0.366,1.367s1.089,0.112,1.366-0.366C20.581,8.702,20.418,8.089,19.938,7.813zM23.378,14.5c-0.554,0.002-1.001,0.45-1.001,1c0.001,0.552,0.448,1,1.001,1c0.551,0,1-0.447,1-1C24.378,14.949,23.929,14.5,23.378,14.5zM15.501,6.624c-0.552,0-1,0.448-1,1l-0.466,7.343l-3.004,1.96c-0.478,0.277-0.642,0.889-0.365,1.365c0.275,0.479,0.889,0.643,1.365,0.367l3.305-1.676C15.39,16.99,15.444,17,15.501,17c0.828,0,1.5-0.671,1.5-1.5l-0.5-7.876C16.501,7.072,16.053,6.624,15.501,6.624zM15.501,22.377c-0.552,0-1,0.447-1,1s0.448,1,1,1s1-0.447,1-1S16.053,22.377,15.501,22.377zM18.939,21.455c-0.479,0.277-0.643,0.889-0.366,1.367c0.275,0.477,0.888,0.643,1.366,0.365c0.478-0.275,0.642-0.889,0.366-1.365C20.028,21.344,19.417,21.18,18.939,21.455z");s.attr({fill:Color.black,stroke:"none"}),s.transform("t -2.374 -2.374"),s.transform("...t -13.126 -13.126"),s.transform("...s "+1*(i/35)+" "+1*(r/35)),s.transform("...T "+t+" "+e),a.attr("rx",s.getBBox().width/2),a.attr("ry",s.getBBox().height/2)
},_drawPentagon:function(t,e,i,r,a){for(var s=5,n=2*Math.PI/s,o=[],h=0;s>h;h++){var l=h*n-Math.PI/2,d={};d.x=1.2*-i/2+parseInt(Math.round(1.2*i/2))+parseInt(Math.round(1.2*i/4*Math.cos(l))),d.y=1.2*-r/2+parseInt(Math.round(1.2*r/2))+parseInt(Math.round(1.2*r/4*Math.sin(l))),o[h]=d}var g=new Polygone(o,this.getStroke());g.element=this.g.path(g.path),a?g.element.attr("fill",Color.black):g.element.attr("fill",Color.white),g.element.transform("s "+1*(i/35)+" "+1*(r/35)),g.element.transform("...T "+t+" "+e)},_drawMultilineText:function(t,e,i,r,a,s,n){if(t&&""!=t){0==a&&(s=MULTILINE_VERTICAL_ALIGN_TOP);var o=r;if(a)var h=a;var l=[],d=this.getFont(),g=new LineBreakMeasurer(this.g,e,i,t,d),E=g.rafaelTextObject.getBBox().height;if(h)var _=parseInt(h/E);for(var c=1;g.getPosition()<g.text.getEndIndex();){var T=g.nextLayout(o);if(null!=T){if(_&&!(_>c)){l.push(this.fitTextToWidth(T+"...",r));break}l.push(T)}c++}g.rafaelTextObject.attr({text:l.join("\n")}),n&&g.rafaelTextObject.attr({"text-anchor":n});var O=g.rafaelTextObject.getBBox();g.rafaelTextObject.attr({y:i+O.height/2}),g.rafaelTextObject.attr("text-anchor")==MULTILINE_HORIZONTAL_ALIGN_MIDDLE?g.rafaelTextObject.attr("x",e+r/2):g.rafaelTextObject.attr("text-anchor")==MULTILINE_HORIZONTAL_ALIGN_RIGHT&&g.rafaelTextObject.attr("x",e+r);var I={stroke:Color.LightSteelBlue2,"stroke-width":1,"stroke-dasharray":"- "},S=e+r/2,h=a;h||(h=O.height);var C=i+h/2,v=this.g.ellipse(e,i,3,3).attr({"stroke-width":0,fill:Color.LightSteelBlue,stroke:"none"}).hide(),u=this.g.ellipse(S,C,3,3).attr({fill:Color.LightSteelBlue2,stroke:"none"}).hide(),N=this.g.rect(e,i,r,h).attr({"stroke-width":1}).attr(I).hide(),w=this.g.set();w.push(v,u,N)}},drawTextAnnotation:function(t,e,i,r,a){var s=18,n=[];n.push(["M",e+s,i]),n.push(["L",e,i]),n.push(["L",e,i+a]),n.push(["L",e+s,i+a]),n.push(["L",e+s,i+a-1]),n.push(["L",e+1,i+a-1]),n.push(["L",e+1,i+1]),n.push(["L",e+s,i+1]),n.push(["z"]);{var o=(this.g.path(n),r-2*ANNOTATION_TEXT_PADDING),h=a-2*ANNOTATION_TEXT_PADDING,l=e+r/2-o/2,d=i+a/2-h/2,g={stroke:Color(112,146,190),"stroke-width":1,"stroke-dasharray":"- "};this.g.rect(l,d,o,h).attr(g)}this.drawAnnotationText(t,l,d,o,h)},drawLabel111111111:function(t,e,i,r,a,s){var n=!1;if(null!=t&&void 0!=t&&""!=t){var o=LABEL_FONT;wrappedText=t,s&&s.wrapWidth&&(wrappedText=this.wrapTextToWidth(wrappedText,s.wrapWidth));var h=this.getStringWidth(wrappedText,o),l=this.getStringHeight(wrappedText,o),d=e+r/2,g=i+3+a+this.getStringHeight(wrappedText,o)/2,E=d,_=g,c={};if(s&&s.align)switch(s.align){case"left":c["text-anchor"]="start",E-=h/2;break;case"center":c["text-anchor"]="middle";break;case"right":c["text-anchor"]="end",E+=h/2}if(s&&s.wrapWidth){var T={stroke:Color.LightSteelBlue2,"stroke-width":1,"stroke-dasharray":"- "},O=d-h/2,I=g+.5-l/2,S=(this.g.rect(O,I,h,l).attr(T),this.g.path("M"+O+" "+I+"L"+(O+h)+" "+(I+l)+"M"+ +(O+h)+" "+I+"L"+O+" "+(I+l)));S.attr(T),this.g.ellipse(d,g,3,3).attr({fill:Color.LightSteelBlue2,stroke:"none"})}var C=this.g.text(E,_,wrappedText).attr(o).attr(c);if(this.fontSmoothing&&C.attr({stroke:LABEL_COLOR,"stroke-width":.4}),n){var v={stroke:Color.grey61,"stroke-width":1,"stroke-dasharray":"- "},u=(this.g.rect(e+.5,i+.5,r,a).attr(v),this.g.path("M"+e+" "+i+"L"+(e+r)+" "+(i+a)+"M"+ +(e+r)+" "+i+"L"+e+" "+(i+a)));u.attr(v);var N={fill:Color.Coral,stroke:"none"};this.g.ellipse(e,i,3,3).attr(N),this.g.ellipse(e+r,i,2,2).attr(N),this.g.ellipse(e+r,i+a,2,2).attr(N),this.g.ellipse(e,i+a,2,2).attr(N)}return C}},vvoid:function(){}};