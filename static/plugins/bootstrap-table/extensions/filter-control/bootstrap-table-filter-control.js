!function(t){"use strict";var e=t.fn.bootstrapTable.utils.sprintf,o=t.fn.bootstrapTable.utils.objectKeys,i=function(t){return t.get(t.length-1).options},r=function(t,o){for(var r=i(t),n=0;n<r.length;n++)""!==r[n].value&&(o.hasOwnProperty(r[n].value)?t.find(e("option[value='%s']",r[n].value)).show():t.find(e("option[value='%s']",r[n].value)).hide())},n=function(e,o,i){o=t.trim(o),e=t(e.get(e.length-1)),l(e,o)||e.append(t("<option></option>").attr("value",o).text(t("<div />").html(i).text()))},a=function(e){var o=e.find("option:gt(0)");o.sort(function(e,o){return e=t(e).text().toLowerCase(),o=t(o).text().toLowerCase(),t.isNumeric(e)&&t.isNumeric(o)&&(e=parseFloat(e),o=parseFloat(o)),e>o?1:o>e?-1:0}),e.find("option:gt(0)").remove(),e.append(o)},l=function(t,e){for(var o=i(t),r=0;r<o.length;r++)if(o[r].value===e.toString())return!0;return!1},s=function(t){t.$tableHeader.css("height","77px")},f=function(t){var e=t.$header;return t.options.height&&(e=t.$tableHeader),e},c=function(t){var e="select, input";return t.options.height&&(e="table select, table input"),e},u=function(e){if(t.fn.bootstrapTable.utils.isIEBrowser()){if(t(e).is("input")){var o=0;if("selectionStart"in e)o=e.selectionStart;else if("selection"in document){e.focus();var i=document.selection.createRange(),r=document.selection.createRange().text.length;i.moveStart("character",-e.value.length),o=i.text.length-r}return o}return-1}return-1},p=function(e,o){t.fn.bootstrapTable.utils.isIEBrowser()&&(void 0!==e.setSelectionRange?e.setSelectionRange(o,o):t(e).val(e.value))},h=function(e){var o=f(e),i=c(e);e.options.valuesFilterControl=[],o.find(i).each(function(){e.options.valuesFilterControl.push({field:t(this).closest("[data-field]").data("field"),value:t(this).val(),position:u(t(this).get(0))})})},d=function(e){var o=null,i=[],r=f(e),n=c(e);e.options.valuesFilterControl.length>0&&r.find(n).each(function(){o=t(this).closest("[data-field]").data("field"),i=t.grep(e.options.valuesFilterControl,function(t){return t.field===o}),i.length>0&&(t(this).val(i[0].value),p(t(this).get(0),i[0].position))})},b=function(){var e=[],o=document.cookie.match(/(?:bs.table.)(\w*)/g);return o?(t.each(o,function(o,i){/./.test(i)&&(i=i.split(".").pop()),-1===t.inArray(i,e)&&e.push(i)}),e):void 0},v=function(e){var o=e.data,i=(e.pageTo<e.options.data.length?e.options.data.length:e.pageTo,function(t){return t.filterControl&&"select"===t.filterControl.toLowerCase()&&t.searchable}),l=function(t){return void 0===t.filterData||"column"===t.filterData.toLowerCase()},s=function(t){return t&&t.length>0},f=e.options.pagination?"server"===e.options.sidePagination?e.pageTo:e.options.totalRows:e.pageTo;t.each(e.header.fields,function(c,u){var p=e.columns[t.fn.bootstrapTable.utils.getFieldIndex(e.columns,u)],h=t(".bootstrap-table-filter-control-"+g(p.field));if(i(p)&&l(p)&&s(h)){0===h.get(h.length-1).options.length&&n(h,"","");for(var d={},b=0;f>b;b++){var v=o[b][u],m=t.fn.bootstrapTable.utils.calculateObjectValue(e.header,e.header.formatters[c],[v,o[b],b],v);d[m]=v}for(var y in d)n(h,d[y],y);a(h),e.options.hideUnusedSelectOptions&&r(h,d)}})},g=function(t){return String(t).replace(/(:|\.|\[|\]|,)/g,"\\$1")},m=function(o,i){var r,l,s=!1,f=0;t.each(o.columns,function(e,f){if(r="hidden",l=[],f.visible){if(f.filterControl){l.push('<div class="filter-control">');var c=f.filterControl.toLowerCase();f.searchable&&o.options.filterTemplate[c]&&(s=!0,r="visible",l.push(o.options.filterTemplate[c](o,f.field,r,f.filterControlPlaceholder)))}else l.push('<div class="no-filter-control"></div>');if(t.each(i.children().children(),function(e,o){return o=t(o),o.data("field")===f.field?(o.find(".fht-cell").append(l.join("")),!1):void 0}),void 0!==f.filterData&&"column"!==f.filterData.toLowerCase()){var u,p,h=T(C,f.filterData.substring(0,f.filterData.indexOf(":")));if(null===h)throw new SyntaxError('Error. You should use any of these allowed filter data methods: var, json, url. Use like this: var: {key: "value"}');u=f.filterData.substring(f.filterData.indexOf(":")+1,f.filterData.length),p=t(".bootstrap-table-filter-control-"+g(f.field)),n(p,"",""),h(u,p);var d,b;switch(h){case"url":t.ajax({url:u,dataType:"json",success:function(t){for(var e in t)n(p,e,t[e]);a(p)}});break;case"var":d=window[u];for(b in d)n(p,b,d[b]);a(p);break;case"jso":d=JSON.parse(u);for(b in d)n(p,b,d[b]);a(p)}}}}),s?(i.off("keyup","input").on("keyup","input",function(t){clearTimeout(f),f=setTimeout(function(){o.onColumnSearch(t)},o.options.searchTimeOut)}),i.off("change","select").on("change","select",function(t){clearTimeout(f),f=setTimeout(function(){o.onColumnSearch(t)},o.options.searchTimeOut)}),i.off("mouseup","input").on("mouseup","input",function(e){var i=t(this),r=i.val();""!==r&&setTimeout(function(){var t=i.val();""===t&&(clearTimeout(f),f=setTimeout(function(){o.onColumnSearch(e)},o.options.searchTimeOut))},1)}),i.find(".date-filter-control").length>0&&t.each(o.columns,function(o,r){void 0!==r.filterControl&&"datepicker"===r.filterControl.toLowerCase()&&i.find(".date-filter-control.bootstrap-table-filter-control-"+r.field).datepicker(r.filterDatepickerOptions).on("changeDate",function(o){t(e(".%s",o.currentTarget.classList.toString().split(" ").join("."))).val(o.currentTarget.value),t(o.currentTarget).keyup()})})):i.find(".filterControl").hide()},y=function(t){switch(t=void 0===t?"left":t.toLowerCase()){case"left":return"ltr";case"right":return"rtl";case"auto":return"auto";default:return"ltr"}},C={"var":function(t,e){var o=window[t];for(var i in o)n(e,i,o[i]);a(e)},url:function(e,o){t.ajax({url:e,dataType:"json",success:function(t){for(var e in t)n(o,e,t[e]);a(o)}})},json:function(t,e){var o=JSON.parse(t);for(var i in o)n(e,i,o[i]);a(e)}},T=function(t,e){for(var o=Object.keys(t),i=0;i<o.length;i++)if(o[i]===e)return t[e];return null};t.extend(t.fn.bootstrapTable.defaults,{filterControl:!1,onColumnSearch:function(){return!1},filterShowClear:!1,alignmentSelectControlOptions:void 0,filterTemplate:{input:function(t,o,i,r){return e('<input type="text" class="form-control bootstrap-table-filter-control-%s" style="width: 100%; visibility: %s" placeholder="%s">',o,i,r)},select:function(t,o,i){return e('<select class="form-control bootstrap-table-filter-control-%s" style="width: 100%; visibility: %s" dir="%s"></select>',o,i,y(t.options.alignmentSelectControlOptions))},datepicker:function(t,o,i){return e('<input type="text" class="form-control date-filter-control bootstrap-table-filter-control-%s" style="width: 100%; visibility: %s">',o,i)}},valuesFilterControl:[]}),t.extend(t.fn.bootstrapTable.COLUMN_DEFAULTS,{filterControl:void 0,filterData:void 0,filterDatepickerOptions:void 0,filterStrictSearch:!1,filterStartsWithSearch:!1,filterControlPlaceholder:""}),t.extend(t.fn.bootstrapTable.Constructor.EVENTS,{"column-search.bs.table":"onColumnSearch"}),t.extend(t.fn.bootstrapTable.defaults.icons,{clear:"glyphicon-trash icon-clear"}),t.extend(t.fn.bootstrapTable.locales,{formatClearFilters:function(){return"Clear Filters"}}),t.extend(t.fn.bootstrapTable.defaults,t.fn.bootstrapTable.locales);var S=t.fn.bootstrapTable.Constructor,w=S.prototype.init,x=S.prototype.initToolbar,O=S.prototype.initHeader,k=S.prototype.initBody,j=S.prototype.initSearch;S.prototype.init=function(){if(this.options.filterControl){var t=this;Object.keys||o(),this.options.valuesFilterControl=[],this.$el.on("reset-view.bs.table",function(){t.options.height&&(t.$tableHeader.find("select").length>0||t.$tableHeader.find("input").length>0||m(t,t.$tableHeader))}).on("post-header.bs.table",function(){d(t)}).on("post-body.bs.table",function(){t.options.height&&s(t)}).on("column-switch.bs.table",function(){d(t)})}w.apply(this,Array.prototype.slice.apply(arguments))},S.prototype.initToolbar=function(){if(this.showToolbar=this.options.filterControl&&this.options.filterShowClear,x.apply(this,Array.prototype.slice.apply(arguments)),this.options.filterControl&&this.options.filterShowClear){var o=this.$toolbar.find(">.btn-group"),i=o.find(".filter-show-clear");i.length||(i=t(['<button class="btn btn-default filter-show-clear" ',e('type="button" title="%s">',this.options.formatClearFilters()),e('<i class="%s %s"></i> ',this.options.iconsPrefix,this.options.icons.clear),"</button>"].join("")).appendTo(o),i.off("click").on("click",t.proxy(this.clearFilterControl,this)))}},S.prototype.initHeader=function(){O.apply(this,Array.prototype.slice.apply(arguments)),this.options.filterControl&&m(this,this.$header)},S.prototype.initBody=function(){k.apply(this,Array.prototype.slice.apply(arguments)),v(this)},S.prototype.initSearch=function(){if(j.apply(this,Array.prototype.slice.apply(arguments)),"server"!==this.options.sidePagination){var e=this,o=t.isEmptyObject(this.filterColumnsPartial)?null:this.filterColumnsPartial;this.data=o?t.grep(this.data,function(i,r){for(var n in o){var a=e.columns[t.fn.bootstrapTable.utils.getFieldIndex(e.columns,n)],l=o[n].toLowerCase(),s=i[n];if(a&&a.searchFormatter&&(s=t.fn.bootstrapTable.utils.calculateObjectValue(e.header,e.header.formatters[t.inArray(n,e.header.fields)],[s,i,r],s)),a.filterStrictSearch){if(-1===t.inArray(n,e.header.fields)||"string"!=typeof s&&"number"!=typeof s||s.toString().toLowerCase()!==l.toString().toLowerCase())return!1}else if(a.filterStartsWithSearch){if(-1===t.inArray(n,e.header.fields)||"string"!=typeof s&&"number"!=typeof s||0!==(s+"").toLowerCase().indexOf(l))return!1}else if(-1===t.inArray(n,e.header.fields)||"string"!=typeof s&&"number"!=typeof s||-1===(s+"").toLowerCase().indexOf(l))return!1}return!0}):this.data}},S.prototype.initColumnSearch=function(t){if(h(this),t){this.filterColumnsPartial=t,this.updatePagination();for(var e in t)this.trigger("column-search",e,t[e])}},S.prototype.onColumnSearch=function(e){if(!(t.inArray(e.keyCode,[37,38,39,40])>-1)){h(this);var o=t.trim(t(e.currentTarget).val()),i=t(e.currentTarget).closest("[data-field]").data("field");t.isEmptyObject(this.filterColumnsPartial)&&(this.filterColumnsPartial={}),o?this.filterColumnsPartial[i]=o:delete this.filterColumnsPartial[i],this.searchText+="randomText",this.options.pageNumber=1,this.onSearch(e),this.trigger("column-search",i,o)}},S.prototype.clearFilterControl=function(){if(this.options.filterControl&&this.options.filterShowClear){var o=this,i=b(),r=f(o),n=r.closest("table"),a=r.find(c(o)),l=o.$toolbar.find(".search input"),s=0;if(t.each(o.options.valuesFilterControl,function(t,e){e.value=""}),d(o),!(a.length>0))return;if(this.filterColumnsPartial={},t(a[0]).trigger("INPUT"===a[0].tagName?"keyup":"change"),l.length>0&&o.resetSearch(),o.options.sortName!==n.data("sortName")||o.options.sortOrder!==n.data("sortOrder")){var u=r.find(e('[data-field="%s"]',t(a[0]).closest("table").data("sortName")));u.length>0&&(o.onSort(n.data("sortName"),n.data("sortName")),t(u).find(".sortable").trigger("click"))}clearTimeout(s),s=setTimeout(function(){i&&i.length>0&&t.each(i,function(t,e){void 0!==o.deleteCookie&&o.deleteCookie(e)})},o.options.searchTimeOut)}}}(jQuery);